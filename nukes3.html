<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuclear Umbrella Collapse · 2025–2040</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/globe.gl"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
    <style>
        body { background: radial-gradient(circle at top left, #1e1b4b, #0f0f1e); min-height: 100vh; }
        .orbitron { font-family: 'Orbitron', sans-serif; }
        .card { background: rgba(30,41,55,0.9); backdrop-filter: blur(12px); border: 1px solid rgba(100,116,139,0.3); }
        @keyframes glow { 0%,100% { text-shadow: 0 0 20px #ff006e; } 50% { text-shadow: 0 0 40px #ff006e, 0 0 60px #ff006e; } }
        h1 { animation: glow 4s infinite; }
        .tab.active { background: linear-gradient(135deg, #dc2626, #f97316); box-shadow: 0 0 30px rgba(239,68,68,0.6); }
        .view-btn.active { background: #1e40af; box-shadow: 0 0 20px rgba(59,130,246,0.7); }
    </style>
</head>
<body class="text-white">
<div class="container mx-auto p-6 max-w-7xl">

    <div class="text-center mb-10 card p-10 rounded-3xl">
        <h1 class="text-5xl md:text-7xl font-black orbitron bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500 bg-clip-text text-transparent">
            NUCLEAR UMBRELLA COLLAPSE
        </h1>
        <p class="text-xl mt-4 text-gray-300">2025 → 2034 → 2040</p>
        <div class="flex justify-center gap-6 mt-8 flex-wrap">
            <button onclick="setYear('current')" class="tab active px-8 py-4 rounded-xl text-lg font-bold" id="tab-current">2025: Status Quo</button>
            <button onclick="setYear('2034')" class="tab px-8 py-4 rounded-xl text-lg font-bold" id="tab-2034">2034: 30% Cut</button>
            <button onclick="setYear('2040')" class="tab px-8 py-4 rounded-xl text-lg font-bold" id="tab-2040">2040: Collapse</button>
        </div>
    </div>

    <div class="grid grid-cols-4 gap-4 mb-8">
        <button onclick="setView('all')" class="view-btn active py-4 rounded-xl font-bold" id="v-all">All</button>
        <button onclick="setView('pacific')" class="view-btn py-4 rounded-xl font-bold" id="v-pacific">Pacific</button>
        <button onclick="setView('atlantic')" class="view-btn py-4 rounded-xl font-bold" id="v-atlantic">Atlantic</button>
        <button onclick="setView('umbrellas')" class="view-btn py-4 rounded-xl font-bold" id="v-umbrellas">Umbrellas</button>
    </div>

    <div id="globeViz" class="card rounded-3xl overflow-hidden shadow-2xl" style="height: 800px;"></div>

    <div class="grid grid-cols-2 md:grid-cols-5 gap-6 mt-10">
        <div class="card p-6 text-center rounded-2xl"><div class="text-5xl">US</div><div class="text-4xl font-black text-blue-400 mt-2" id="us-warheads">5,244</div><div class="text-sm text-gray-400">Warheads</div></div>
        <div class="card p-6 text-center rounded-2xl"><div class="text-5xl">RU+CN</div><div class="text-4xl font-black text-green-400 mt-2" id="rc-warheads">7,420</div><div class="text-sm text-gray-400">Sino-Russian</div></div>
        <div class="card p-6 text-center rounded-2xl"><div class="text-5xl">PK/SA</div><div class="text-3xl font-black text-cyan-400 mt-2">~520</div></div>
        <div class="card p-6 text-center rounded-2xl"><div class="text-5xl">IL</div><div class="text-3xl font-black text-gray-300 mt-2">~90</div></div>
        <div class="card p-6 text-center rounded-2xl"><div class="text-5xl">IN</div><div class="text-3xl font-black text-amber-400 mt-2">~300</div></div>
    </div>

    <div class="card p-10 mt-10 rounded-3xl">
        <h2 class="text-4xl font-black orbitron text-yellow-400 mb-8">Strategic Implications</h2>
        <div id="implications" class="text-lg leading-relaxed text-gray-200"></div>
    </div>
</div>

<script>
let globe, currentYear = 'current', currentView = 'all';

// ==================== FULL CURRENT PATROLS (2025) ====================
const currentPatrols = [
    {coords: [[47.73,-122.71],[50,-140],[52,-160],[50,-175],[45,170],[40,160],[35,150],[30,140],[35,130],[40,135],[45,140],[47.73,-122.71]], color:'#3b82f6', name:'U.S. Pacific SSBN Patrol'},
    {coords: [[30.80,-81.55],[35,-70],[40,-60],[50,-45],[60,-30],[65,-20],[62,-10],[58,0],[55,10],[50,5],[45,-10],[40,-25],[35,-40],[30.80,-81.55]], color:'#8b5cf6', name:'U.S. Atlantic SSBN Patrol'},
    {coords: [[56.03,-4.92],[55,-20],[60,-30],[50,-40],[55,-35],[56.03,-4.92]], color:'#8b5cf6', name:'UK Vanguard SSBN'},
    {coords: [[48.39,-4.49],[50,-20],[55,-30],[45,-35],[48.39,-4.49]], color:'#8b5cf6', name:'French Le Triomphant SSBN'},
    {coords: [[53.01,158.65],[55,165],[58,170],[60,175],[58,-175],[55,-170],[52,-165],[50,160],[53.01,158.65]], color:'#94a3b8', name:'Russian Pacific SSBN'},
    {coords: [[69.26,33.33],[72,35],[75,30],[75,20],[73,10],[70,5],[68,15],[69,25],[69.26,33.33]], color:'#94a3b8', name:'Russian Atlantic SSBN'},
    {coords: [[18.24,109.51],[15,115],[12,120],[10,125],[15,130],[20,128],[22,120],[18.24,109.51]], color:'#94a3b8', name:'Chinese SSBN Bastion'},
    {coords: [[17.68,83.22],[15,85],[12,88],[10,90],[8,92],[10,95],[12,93],[15,90],[18,87],[20,85],[17.68,83.22]], color:'#b45309', name:'Indian SSBN'},
    {coords: [[21.35,-157.92],[20,-160],[15,-170],[10,160],[15,150],[20,140],[21.35,-157.92]], color:'#ef4444', name:'US SSN Pacific'},
    {coords: [[-7.32,72.42],[-10,75],[-12,80],[-15,85],[-18,90],[-20,95],[-22,100],[-25,105],[-28,110],[-30,112],[-32,115.77]], color:'#ef4444', name:'US SSN Indian Ocean'},
    {coords: [[-7.32,72.42],[-5,70],[-3,68],[0,65],[3,62],[5,60],[3,65],[0,68],[-3,70],[-7.32,72.42]], color:'#ef4444', name:'US SSN Diego Garcia'},
    {coords: [[-7.32,72.42],[0,80],[2,90],[3,98],[2,102],[1,101],[2,100],[3,98],[0,90],[-7.32,72.42]], color:'#ef4444', name:'US SSN Malacca'},
    {coords: [[-7.32,72.42],[0,65],[10,60],[20,58],[26,56],[27,55],[26,56.5],[20,58],[10,60],[-7.32,72.42]], color:'#ef4444', name:'US SSN Hormuz'},
    {coords: [[36.94,-76.33],[40,-70],[45,-60],[50,-50],[45,-55],[40,-65],[36.94,-76.33]], color:'#f97316', name:'US SSN Atlantic'},
    {coords: [[69.26,33.33],[70,20],[75,10],[70,0],[65,15],[69.26,33.33]], color:'#22c55e', name:'Russian Yasen Arctic'},
    {coords: [[18.24,109.51],[15,115],[12,120],[10,125],[12,130],[15,125],[18.24,109.51]], color:'#22c55e', name:'Chinese SSN'},
    {coords: [[18.24,109.51],[20,118],[23,123],[25,126],[26,128],[25,127],[23,124],[20,120],[18.24,109.51]], color:'#22c55e', name:'Chinese SSN Miyako'},
    {coords: [[18.24,109.51],[18,115],[19,120],[20,122],[19,121],[18,118],[18.24,109.51]], color:'#22c55e', name:'Chinese SSN Luzon'},
    {coords: [[33.59,130.40],[30,128],[27,125],[25,123],[23,121],[21,120],[19,121],[20,122],[22,121.5],[24,122],[26,124],[28,127],[30,129],[33.59,130.40]], color:'#ef4444', name:'Japan SSK First Island Chain'},
    {coords: [[17.68,83.22],[15,80],[12,75],[10,70],[8,65],[5,70],[8,75],[12,80],[15,82],[17.68,83.22]], color:'#b45309', name:'Indian SSN'},
    {coords: [[56.03,-4.92],[55,-15],[50,-25],[45,-20],[50,-10],[56.03,-4.92]], color:'#f97316', name:'UK Astute SSN'},
    {coords: [[56.03,-4.92],[58,-10],[60,-15],[62,-20],[64,-25],[62,-22],[60,-18],[58,-12],[56.03,-4.92]], color:'#f97316', name:'UK SSN GIUK'},
    {coords: [[48.39,-4.49],[50,-15],[45,-25],[40,-20],[45,-10],[48.39,-4.49]], color:'#f97316', name:'French Suffren SSN'}
];

// 2034 & 2040 use simplified versions
const patrols = {
    current: currentPatrols,
    '2034': [
        {coords: [[47.73,-122.71],[48,-150],[45,-165],[40,-175],[47.73,-122.71]], color:'#3b82f6', name:'U.S. Pacific SSBN (Reduced)'},
        {coords: [[30.80,-81.55],[38,-70],[48,-50],[52,-30],[45,-20],[30.80,-81.55]], color:'#8b5cf6', name:'U.S. Atlantic SSBN (Reduced)'},
        {coords: [[21.35,-157.92],[15,-170],[10,170],[15,155],[21.35,-157.92]], color:'#ef4444', name:'U.S. SSN Hawaii Ring'},
        {coords: [[18.24,109.51],[20,130],[28,145],[25,160],[18.24,109.51]], color:'#22c55e', name:'China SSBN → Second Island Chain'},
        {coords: [[18.24,109.51],[5,110],[-10,105],[-20,115],[-10,130],[5,125],[18.24,109.51]], color:'#22c55e', name:'China SSN → Northern Australia'},
        {coords: [[69.26,33.33],[70,10],[68,-10],[65,-25],[69.26,33.33]], color:'#94a3b8', name:'Russia → GIUK Penetration'}
    ],
    '2040': [
        {coords: [[47.73,-122.71],[35,-140],[25,-150],[21.35,-157.92],[30,-165],[47.73,-122.71]], color:'#3b82f6', name:'U.S. Pacific SSBN – Hawaiian Sanctuary'},
        {coords: [[30.80,-81.55],[35,-75],[40,-68],[38,-65],[30.80,-81.55]], color:'#8b5cf6', name:'U.S. Atlantic SSBN – East Coast Bastion'},
        {coords: [[40,-75],[48,-60],[45,-50],[38,-65],[40,-75]], color:'#ef4444', name:'U.S. SSN East Coast Ring'},
        {coords: [[25,-90],[15,-100],[5,-105],[-5,-95],[25,-90]], color:'#ef4444', name:'U.S. SSN Caribbean Ring'},
        {coords: [[18.24,109.51],[22,150],[20,170],[15,175],[18.24,109.51]], color:'#22c55e', name:'China SSBN → Hawaii'},
        {coords: [[18.24,109.51],[40,165],[50,-170],[45,175],[18.24,109.51]], color:'#22c55e', name:'China SSBN → Alaska'},
        {coords: [[18.24,109.51],[0,115],[-25,110],[-40,130],[-35,160],[-10,165],[10,150],[18.24,109.51]], color:'#22c55e', name:'China SSN Encirclement of Australia'},
        {coords: [[56,-5],[68,5],[70,20],[65,30],[56,-5]], color:'#8b5cf6', name:'UK/French GIUK Defense'}
    ]
};

function getPatrols() {
    return patrols[currentYear].map(p => ({coords: p.coords, color: p.color, label: p.name}));
}

// ==================== UMBRELLA ZONES ====================
function getUmbrella(country) {
    const sinoRusCore = ['Russia','China','North Korea','Iran','Venezuela','Cuba'];
    const usCore = ['United States of America','Canada','Mexico','United Kingdom','France','Germany','Italy','Poland'];

    if (currentYear === '2040') {
        const sinoRus2040 = [...sinoRusCore, 'Japan','South Korea','Australia','New Zealand','Philippines','Thailand','Singapore','Taiwan','Indonesia','Malaysia','Vietnam','Cambodia','Laos','Myanmar'];
        if (sinoRus2040.includes(country)) return {col:'rgba(34,197,94,0.95)', name:'Sino-Russian Bloc'};
    }
    if (currentYear === '2034') {
        if (['Taiwan','Philippines'].includes(country)) return {col:'rgba(34,197,94,0.6)', name:'Sino-Russian Influence'};
    }
    if (usCore.includes(country)) return {col:'rgba(59,130,246,0.7)', name:'U.S. Umbrella'};
    if (sinoRusCore.includes(country)) return {col:'rgba(34,197,94,0.7)', name:'Sino-Russian Core'};
    return {col:'rgba(60,60,80,0.4)', name:'Neutral'};
}

// ==================== WARHEAD COUNTERS ====================
function updateNumbers() {
    let us = 5244, rc = 7420;
    if (currentYear === '2034') { us = 3660; rc = 11130; }
    if (currentYear === '2040') { us = 2100; rc = 18500; }
    document.getElementById('us-warheads').textContent = us.toLocaleString();
    document.getElementById('rc-warheads').textContent = rc.toLocaleString();
}

// ==================== IMPLICATIONS ====================
function renderImplications() {
    const el = document.getElementById('implications');
    if (currentYear === '2040') {
        el.innerHTML = `
            <h3 class="text-4xl font-bold text-red-600 mb-6">2040: THE U.S. NUCLEAR UMBRELLA IS DEAD</h3>
            <ul class="space-y-5 text-xl">
                <li>Japan and South Korea now under effective Chinese protection</li>
                <li>Australia, New Zealand, and all of Southeast Asia lost</li>
                <li>U.S. SSBNs confined to Hawaii and East Coast</li>
                <li>China patrols off Hawaii and Alaska</li>
                <li>Chinese SSNs fully encircle Australia</li>
                <li>Only UK & France defend the North Atlantic</li>
                <li class="text-3xl font-black text-yellow-500 mt-10">The post-1945 world order has ended.</li>
            </ul>`;
    } else if (currentYear === '2034') {
        el.innerHTML = `<h3 class="text-3xl font-bold text-orange-500 mb-6">2034: The Umbrella Begins to Tear</h3><p class="text-lg">Taiwan & Philippines lose credible protection. Japan and South Korea go nuclear-latent.</p>`;
    } else {
        el.innerHTML = `<p class="text-xl">2025: Full U.S. extended deterrence. Global SSBN/SSN presence.</p>`;
    }
}

// ==================== GLOBE ====================
async function initGlobe() {
    const resp = await fetch('https://unpkg.com/world-atlas/countries-110m.json');
    const topo = await resp.json();
    const countries = topojson.feature(topo, topo.objects.countries).features;

    globe = Globe()(document.getElementById('globeViz'))
        .globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg')
        .backgroundImageUrl('//unpkg.com/three-globe/example/img/night-sky.png')
        .pointOfView({lat:25, lng:130, altitude:2.8})
        .polygonsData(countries)
        .polygonCapColor(f => getUmbrella(f.properties.name).col)
        .polygonSideColor(() => 'rgba(0,0,0,0.2)')
        .polygonStrokeColor(() => '#333')
        .polygonLabel(f => `<b>${f.properties.name}</b><br>${getUmbrella(f.properties.name).name}`)
        .pathsData(getPatrols())
        .pathPoints('coords')
        .pathPointLat(p => p[0])
        .pathPointLng(p => p[1])
        .pathColor('color')
        .pathLabel('label')
        .pathStroke(3.5)
        .pathDashLength(0.25)
        .pathDashGap(0.12)
        .pathDashAnimateTime(12000);
}

function setView(v) {
    currentView = v;
    document.querySelectorAll('.view-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById('v-'+v).classList.add('active');
    globe.pathsData(v==='umbrellas' ? [] : getPatrols());
}

function setYear(y) {
    currentYear = y;
    document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
    document.getElementById('tab-'+y).classList.add('active');
    globe.pathsData(getPatrols()).polygonsData(globe.polygonsData());
    updateNumbers();
    renderImplications();
}

initGlobe().then(() => {
    updateNumbers();
    renderImplications();
});
</script>
</body>
</html>
