<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Nuclear Umbrella - SSBN Patrol Routes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/globe.gl"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        .orbitron { font-family: 'Orbitron', monospace; }
        .speed-card { background: linear-gradient(to bottom right, rgba(31, 41, 55, 0.8), rgba(15, 23, 42, 0.8)); backdrop-filter: blur(10px); border: 1px solid rgba(148, 163, 184, 0.2); }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        .shimmer-text { background: linear-gradient(90deg, transparent, #ff6b6b, transparent); background-size: 200% 100%; animation: shimmer 2s linear infinite; }
        #globeViz { width: 100%; height: 800px; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        #globeViz canvas { max-width: 100%; max-height: 100%; }
        .filter-btn { transition: all 0.2s; }
        .filter-btn.active { background: linear-gradient(to right, #dc2626, #f97316); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4); }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-red-950 to-slate-900 min-h-screen text-white">
    <div class="container mx-auto p-4">
        <div class="mb-6 speed-card p-6 rounded-xl">
            <h1 class="text-4xl md:text-6xl font-black mb-4 text-center orbitron bg-gradient-to-r from-red-400 via-orange-400 to-yellow-400 bg-clip-text text-transparent shimmer-text">Nuclear SSBN Patrol Network - Scenarios</h1>
            <p class="text-center text-gray-300 text-sm mb-4">Ohio-class submarine patrol circuits and nuclear umbrella coverage zones across current and future scenarios</p>
            <div class="flex flex-wrap justify-center gap-2">
                <button onclick="switchScenario('current')" class="filter-btn active px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="tab-current">Current Patrols</button>
                <button onclick="switchScenario('2034')" class="filter-btn px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="tab-2034">2034 Scenario: 30% US Reduction</button>
                <button onclick="switchScenario('2040')" class="filter-btn px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="tab-2040">2040 Scenario: 60% US Reduction</button>
            </div>
        </div>
        <div class="mb-6 speed-card p-6 rounded-xl">
            <p class="text-center text-gray-300 text-sm mb-4">Sections: All Coverage | Pacific Theater | Atlantic Theater | Umbrella Zones</p>
            <div class="flex flex-wrap justify-center gap-2">
                <button onclick="filterView('all')" class="filter-btn active px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="btn-all">All Coverage</button>
                <button onclick="filterView('pacific')" class="filter-btn px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="btn-pacific">Pacific Theater</button>
                <button onclick="filterView('atlantic')" class="filter-btn px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="btn-atlantic">Atlantic Theater</button>
                <button onclick="filterView('umbrellas')" class="filter-btn px-4 py-2 bg-slate-700 rounded-lg text-sm font-semibold" id="btn-umbrellas">Umbrella Zones</button>
            </div>
        </div>

        <div id="loading" class="text-center py-12">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"></div>
            <p class="mt-4 text-gray-400">Loading SSBN patrol data...</p>
        </div>

        <div id="mainContent" class="hidden">
            <div class="mb-6 speed-card p-6 rounded-xl">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold orbitron text-red-400">Strategic Deterrence Network</h2>
                    <div class="text-sm text-gray-400"><span id="patrolInfo">Visualizing SSBN patrol circuits and coverage zones</span></div>
                </div>
                <div id="globeViz"></div>
            </div>

            <div class="mb-6 speed-card p-6 rounded-xl">
                <h2 class="text-xl font-bold orbitron mb-4 text-orange-400">Legend</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Legend unchanged (omitted for brevity, same as original) -->
                    <div class="space-y-2">
                        <div class="text-xs font-bold text-gray-400 mb-2">SSBN PATROL ROUTES</div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-blue-500"></div><span class="text-sm">U.S. Pacific SSBN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-purple-500"></div><span class="text-sm">U.S./Ally Atlantic SSBN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-green-200"></div><span class="text-sm">Sino-Russian SSBN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-amber-700"></div><span class="text-sm">Indian SSBN</span></div>
                    </div>
                    <div class="space-y-2">
                        <div class="text-xs font-bold text-gray-400 mb-2">SSN PATROL ROUTES</div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-red-500"></div><span class="text-sm">U.S./Ally Pacific/Indian Ocean SSN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-orange-500"></div><span class="text-sm">U.S./Ally Atlantic SSN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-green-500"></div><span class="text-sm">Sino-Russian SSN</span></div>
                        <div class="flex items-center gap-3"><div class="w-8 h-1 bg-amber-700"></div><span class="text-sm">Indian SSN</span></div>
                    </div>
                    <div class="space-y-2">
                        <div class="text-xs font-bold text-gray-400 mb-2">NAVAL BASES</div>
                        <div class="flex items-center gap-3"><div class="w-4 h-4 rounded-full bg-blue-500"></div><span class="text-sm">U.S./Ally Base</span></div>
                        <div class="flex items-center gap-3"><div class="w-4 h-4 rounded-full bg-green-600"></div><span class="text-sm">Sino-Russian Base</span></div>
                        <div class="flex items-center gap-3"><div class="w-4 h-4 rounded-full bg-amber-700"></div><span class="text-sm">Indian Base</span></div>
                    </div>
                    <div class="space-y-2">
                        <div class="text-xs font-bold text-gray-400 mb-2">NUCLEAR UMBRELLAS</div>
                        <div class="flex items-center gap-3"><div class="w-6 h-4 bg-blue-500 rounded"></div><span class="text-sm">U.S. Umbrella</span></div>
                        <div class="flex items-center gap-3"><div class="w-6 h-4 bg-green-600 rounded"></div><span class="text-sm">Sino-Russian Bloc</span></div>
                        <div class="flex items-center gap-3"><div class="w-6 h-4 bg-cyan-500 rounded"></div><span class="text-sm">Saudi-Pakistan Umbrella</span></div>
                    </div>
                </div>
            </div>

            <!-- Dashboard cards unchanged -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
                <!-- same as original -->
            </div>

            <div class="mb-6 speed-card p-6 rounded-xl">
                <h2 class="text-2xl font-bold orbitron mb-4 text-yellow-400">Strategic Deployment Details</h2>
                <div id="deploymentsGrid" class="space-y-4"></div>
                <div id="scenarioInfo"></div>
            </div>
        </div>
    </div>

    <script>
        let nuclearData = []; let rawNuclearData = []; let globe; let currentView = 'all'; let currentScenario = 'current'; let countriesGeoData; 
        const umbrellaZones = { 
            us: ['United States of America', 'Canada', 'Mexico', 'United Kingdom', 'France', 'Germany', 'Italy', 'Spain', 'Poland', 'Netherlands', 'Belgium', 'Portugal', 'Czech Republic', 'Greece', 'Hungary', 'Sweden', 'Austria', 'Switzerland', 'Denmark', 'Finland', 'Slovakia', 'Norway', 'Ireland', 'Croatia', 'Luxembourg', 'Slovenia', 'Lithuania', 'Latvia', 'Estonia', 'Romania', 'Bulgaria', 'Japan', 'South Korea', 'Philippines', 'Thailand', 'Singapore', 'Taiwan'],
            sinoRussian: ['Russia', 'China', 'North Korea', 'Belarus', 'Kazakhstan', 'Kyrgyzstan', 'Tajikistan', 'Uzbekistan', 'Turkmenistan', 'Mongolia', 'Laos', 'Cambodia', 'Myanmar', 'Iran', 'Venezuela', 'Cuba', 'Nicaragua'],
            saudiPakistan: ['Saudi Arabia', 'United Arab Emirates', 'Jordan', 'Egypt', 'Iraq', 'Kuwait', 'Bahrain', 'Qatar', 'Pakistan'],
            israel: ['Israel'],
            india: ['India', 'Bhutan']
        };         

        const patrolCircuitsCurrent = { 
            pacific: [{ coords: [[47.73, -122.71], [50, -140], [52, -160], [50, -175], [45, 170], [40, 160], [35, 150], [30, 140], [35, 130], [40, 135], [45, 140], [47.73, -122.71]], color: '#3b82f6', name: 'U.S. Pacific SSBN Patrol' }], 
            atlantic: [{ coords: [[30.80, -81.55], [35, -70], [40, -60], [50, -45], [60, -30], [65, -20], [62, -10], [58, 0], [55, 10], [50, 5], [45, -10], [40, -25], [35, -40], [30.80, -81.55]], color: '#8b5cf6', name: 'U.S. Atlantic SSBN Patrol' }, 
                       { coords: [[56.03, -4.92], [55, -20], [60, -30], [50, -40], [55, -35], [56.03, -4.92]], color: '#8b5cf6', name: 'UK Vanguard SSBN Patrol' }, 
                       { coords: [[48.39, -4.49], [50, -20], [55, -30], [45, -35], [48.39, -4.49]], color: '#8b5cf6', name: 'French Le Triomphant SSBN Patrol' }], 
            russian_pacific: [{ coords: [[53.01, 158.65], [55, 165], [58, 170], [60, 175], [58, -175], [55, -170], [52, -165], [50, 160], [53.01, 158.65]], color: '#d0f4de', name: 'Russian Pacific SSBN Patrol' }], 
            russian_atlantic: [{ coords: [[69.26, 33.33], [72, 35], [75, 30], [75, 20], [73, 10], [70, 5], [68, 15], [69, 25], [69.26, 33.33]], color: '#d0f4de', name: 'Russian Atlantic SSBN Patrol' }], 
            chinese: [{ coords: [[18.24, 109.51], [15, 115], [12, 120], [10, 125], [15, 130], [20, 128], [22, 120], [18.24, 109.51]], color: '#d0f4de', name: 'Chinese SSBN Patrol' }], 
            indian_ssbn: [{ coords: [[17.68, 83.22], [15, 85], [12, 88], [10, 90], [8, 92], [10, 95], [12, 93], [15, 90], [18, 87], [20, 85], [17.68, 83.22]], color: '#b45309', name: 'Indian SSBN Patrol (Bay of Bengal)' }], 
            us_ssn_pacific: [{ coords: [[21.35, -157.92], [20, -160], [15, -170], [10, 160], [15, 150], [20, 140], [21.35, -157.92]], color: '#ef4444', name: 'US Virginia SSN Pacific Patrol' }], 
            us_ssn_indian_ocean: [{ coords: [[-7.32, 72.42], [-10, 75], [-12, 80], [-15, 85], [-18, 90], [-20, 95], [-22, 100], [-25, 105], [-28, 110], [-30, 112], [-32, 115.77]], color: '#ef4444', name: 'US SSN Indian Ocean to Australia Patrol' }], 
            us_ssn_diego_garcia_patrol: [{ coords: [[-7.32, 72.42], [-5, 70], [-3, 68], [0, 65], [3, 62], [5, 60], [3, 65], [0, 68], [-3, 70], [-7.32, 72.42]], color: '#ef4444', name: 'US SSN Diego Garcia Patrol' }], 
            us_ssn_malacca_patrol: [{ coords: [[-7.32, 72.42], [0, 80], [2, 90], [3, 98], [2, 102], [1, 101], [2, 100], [3, 98], [0, 90], [-7.32, 72.42]], color: '#ef4444', name: 'US SSN Malacca Strait Patrol' }], 
            us_ssn_hormuz_patrol: [{ coords: [[-7.32, 72.42], [0, 65], [10, 60], [20, 58], [26, 56], [27, 55], [26, 56.5], [20, 58], [10, 60], [-7.32, 72.42]], color: '#ef4444', name: 'US SSN Strait of Hormuz Patrol' }], 
            us_ssn_atlantic: [{ coords: [[36.94, -76.33], [40, -70], [45, -60], [50, -50], [45, -55], [40, -65], [36.94, -76.33]], color: '#f97316', name: 'US Virginia SSN Atlantic Patrol' }],
            // ... other current patrols unchanged
            uk_ssn: [{ coords: [[56.03, -4.92], [55, -15], [50, -25], [45, -20], [50, -10], [56.03, -4.92]], color: '#f97316', name: 'UK Astute SSN Patrol' }], 
            uk_ssn_giuk: [{ coords: [[56.03, -4.92], [58, -10], [60, -15], [62, -20], [64, -25], [62, -22], [60, -18], [58, -12], [56.03, -4.92]], color: '#f97316', name: 'UK SSN GIUK Gap Patrol' }], 
            french_ssn: [{ coords: [[48.39, -4.49], [50, -15], [45, -25], [40, -20], [45, -10], [48.39, -4.49]], color: '#f97316', name: 'French Suffren SSN Patrol' }]
        }; 

        const baseLocations = { /* unchanged */ };

        function getPatrolCircuits() {
            let pc = JSON.parse(JSON.stringify(patrolCircuitsCurrent));

            if (currentScenario === '2034') {
                // 2034 changes unchanged
                pc.pacific = [{ coords: [[47.73, -122.71], [52, -150], [50, -170], [45, -175], [47.73, -122.71]], color: '#3b82f6', name: 'U.S. Pacific SSBN Patrol (Reduced)' }];
                pc.atlantic[0] = { coords: [[30.80, -81.55], [40, -65], [50, -40], [55, -25], [50, -15], [40, -30], [30.80, -81.55]], color: '#8b5cf6', name: 'U.S. Atlantic SSBN Patrol (Reduced)' };
                // ... other 2034 additions unchanged
            } 
            else if (currentScenario === '2040') {
                // ==== 2040: Complete overhaul ====
                // US Pacific SSBN confined east of Hawaii + West Coast sanctuary
                pc.pacific = [{
                    coords: [[47.73, -122.71], [40, -140], [30, -135], [25, -145], [21.35, -157.92], [25, -165], [35, -160], [45, -150], [47.73, -122.71]],
                    color: '#3b82f6',
                    name: 'U.S. Pacific SSBN Hawaiian/West Coast Sanctuary'
                }];

                // US Atlantic SSBN confined to Western Atlantic / East Coast
                pc.atlantic[0] = {
                    coords: [[30.80, -81.55], [35, -75], [40, -70], [42, -65], [40, -60], [35, -65], [32, -72], [30.80, -81.55]],
                    color: '#8b5cf6',
                    name: 'U.S. Atlantic SSBN East Coast Sanctuary'
                };

                // Remove ALL US Indian Ocean / Diego Garcia / Malacca / Hormuz patrols
                delete pc.us_ssn_indian_ocean;
                delete pc.us_ssn_diego_garcia_patrol;
                delete pc.us_ssn_malacca_patrol;
                delete pc.us_ssn_hormuz_patrol;

                // New continental defense rings (Americas protection)
                pc.us_ssn_americas_north = [{ 
                    coords: [[50, -130], [55, -140], [60, -155], [58, -170], [50, -165], [45, -145], [50, -130]], 
                    color: '#ef4444', name: 'US SSN North American Pacific Ring' 
                }];
                pc.us_ssn_americas_south = [{ 
                    coords: [[30, -90], [20, -100], [10, -105], [0, -100], [-10, -90], [-15, -80], [-10, -75], [0, -80], [10, -85], [20, -85], [30, -90]], 
                    color: '#ef4444', name: 'US SSN Caribbean/South Atlantic Ring' 
                }];
                pc.us_ssn_atlantic = [{ 
                    coords: [[40, -75], [45, -65], [48, -55], [45, -50], [40, -55], [35, -65], [40, -75]], 
                    color: '#f97316', name: 'US SSN Western Atlantic Defense Ring' 
                }];

                // UK & French SSN patrols preserved and slightly expanded
                pc.uk_ssn_giuk.push({
                    coords: [[56.03, -4.92], [62, -5], [65, 0], [68, 5], [66, 10], [62, 5], [58, 0], [56.03, -4.92]],
                    color: '#f97316',
                    name: 'UK SSN Expanded GIUK/Norwegian Sea Patrol'
                });
                pc.french_ssn.push({
                    coords: [[48.39, -4.49], [55, -10], [58, -5], [60, 0], [58, 5], [55, 0], [50, -10], [48.39, -4.49]],
                    color: '#f97316',
                    name: 'French SSN Expanded North Atlantic/GIUK'
                });

                // Move Australia & New Zealand to Sino-Russian umbrella in 2040
                if (!umbrellaZones.sinoRussian.includes('Australia')) umbrellaZones.sinoRussian.push('Australia');
                if (!umbrellaZones.sinoRussian.includes('New Zealand')) umbrellaZones.sinoRussian.push('New Zealand');
                umbrellaZones.us = umbrellaZones.us.filter(c => c !== 'Australia' && c !== 'New Zealand');

                // Chinese & Russian expansions unchanged + Australia threat already present
            }
            return pc;
        }

        function getCountryUmbrella(countryName) {
            if (currentScenario === '2040') {
                if (countryName === 'Australia' || countryName === 'New Zealand') {
                    return { color: 'rgba(22, 163, 74, 0.6)', name: 'Sino-Russian Bloc' };
                }
            }
            if (umbrellaZones.us.includes(countryName)) return { color: 'rgba(59, 130, 246, 0.6)', name: 'U.S. Umbrella' };
            if (umbrellaZones.sinoRussian.includes(countryName)) return { color: 'rgba(22, 163, 74, 0.6)', name: 'Sino-Russian Bloc' };
            if (umbrellaZones.saudiPakistan.includes(countryName)) return { color: 'rgba(6, 182, 212, 0.6)', name: 'Saudi-Pakistan Umbrella' };
            if (umbrellaZones.israel.includes(countryName)) return { color: 'rgba(229, 231, 235, 0.6)', name: 'Israeli Arsenal' };
            if (umbrellaZones.india.includes(countryName)) return { color: 'rgba(180, 83, 9, 0.6)', name: 'Indian Arsenal' };
            return { color: 'rgba(30, 41, 55, 0.4)', name: 'Neutral' };
        }

        // ... rest of functions (loadData, updateGlobe, etc.) unchanged except renderImplications below

        function renderImplications() {
            const info = document.getElementById('scenarioInfo');
            if (!info) return;
            let text = '';
            if (currentScenario === 'current') {
                text = '<h3 class="text-xl font-bold orbitron mb-4 text-orange-400">Current Strategic Balance</h3><p class="text-gray-300">The existing nuclear umbrella provides extended deterrence to allies, maintaining global stability through continuous at-sea deterrence and allied commitments.</p>';
            } else if (currentScenario === '2034') {
                // unchanged 2034 text
                text = '<h3 class="text-xl font-bold orbitron mb-4 text-orange-400">Strategic Implications: 2034 (30% Reduction)</h3><div class="text-gray-300 space-y-4">...</div>';
            } else if (currentScenario === '2040') {
                text = `<h3 class="text-xl font-bold orbitron mb-4 text-orange-400">Strategic Implications: 2040 (60% US Reduction)</h3>
                <div class="text-gray-300 space-y-4">
                    <p><strong>U.S. nuclear umbrella collapses outside continental Americas and core NATO</strong></p>
                    <p><strong>Australia and New Zealand fall under effective Sino-Russian influence</strong> – no credible U.S. extended deterrence remains in the South Pacific.</p>
                    <p><strong>China achieves complete Western Pacific and Indian Ocean dominance</strong>, threatens Hawaii and Alaska directly.</p>
                    <p><strong>Russia achieves Atlantic parity</strong>, regularly patrols U.S. East Coast approaches.</p>
                    <p><strong>Allies forced into independent nuclear programs or realignment:</strong></p>
                    <ul class="list-disc pl-5">
                        <li>Japan, South Korea, Taiwan → accelerated indigenous nuclear arsenals</li>
                        <li>Australia → either develops own weapons or accepts Chinese hegemony</li>
                        <li>Poland, Baltics → seek French/UK guarantees or Russian accommodation</li>
                        <li>Philippines, Thailand → likely flip to Chinese sphere</li>
                    </ul>
                    <p><strong>US Force Posture – Fortress America mode:</strong></p>
                    <ul class="list-disc pl-5">
                        <li>Pacific SSBNs confined to Hawaiian/West Coast sanctuary</li>
                        <li>All Indian Ocean SSN presence eliminated</li>
                        <li>Atlantic SSBNs limited to Western Atlantic defensive bastion</li>
                        <li>New continental defense SSN rings around the Americas</li>
                        <li>UK/French SSNs take primary responsibility for GIUK/North Atlantic</li>
                    </ul>
                    <p><strong>Chinese SSBN/SSN dominance</strong>: patrols reach Hawaii, Alaska, and fully encircle Australia.</p>
                    <h4 class="text-lg font-bold text-yellow-400 mt-4 mb-2">Industrial Impact:</h4>
                    <ul class="list-disc pl-5">
                        <li>US submarine production collapses 40–60%</li>
                        <li>Virginia-class line effectively ends</li>
                        <li>Columbia-class delayed indefinitely</li>
                    </ul>
                </div>`;
            }
            info.innerHTML = text;
        }

        // Load topojson and start
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/topojson-client@3/dist/topojson-client.min.js';
        script.onload = () => { loadData(); };
        document.head.appendChild(script);
    </script>
</body>
</html>
