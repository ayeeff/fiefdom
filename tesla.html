<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tesla China Supply Chain Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-red-900 to-slate-900 min-h-screen p-6">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-gradient-to-r from-red-600 to-gray-800 rounded-xl shadow-2xl p-8 mb-6">
            <h1 class="text-4xl font-bold text-white mb-2">âš¡ Tesla China Supply Chain</h1>
            <p class="text-red-100">Manufacturing & Battery Production Network</p>
        </div>
        
        <!-- Key Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
                <div class="text-3xl font-bold text-red-400 mb-2">7</div>
                <div class="text-sm text-gray-300">Manufacturing Sites</div>
            </div>
            <div class="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
                <div class="text-3xl font-bold text-yellow-400 mb-2">5</div>
                <div class="text-sm text-gray-300">Provinces</div>
            </div>
            <div class="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
                <div class="text-3xl font-bold text-green-400 mb-2">750k+</div>
                <div class="text-sm text-gray-300">Vehicle Capacity</div>
            </div>
            <div class="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
                <div class="text-3xl font-bold text-blue-400 mb-2">120GWh</div>
                <div class="text-sm text-gray-300">Battery Capacity</div>
            </div>
        </div>
        
        <!-- Charts Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Geographic Distribution Map -->
            <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                <h2 class="text-xl font-bold text-white mb-4">Geographic Distribution</h2>
                <div id="mapContainer" class="h-96 rounded-lg overflow-hidden"></div>
            </div>
            
            <!-- Production Focus by Site -->
            <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                <h2 class="text-xl font-bold text-white mb-4">Supply Chain Categories</h2>
                <div id="productChart" class="h-96"></div>
            </div>
        </div>
        
        <!-- Site Details Table -->
        <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
            <h2 class="text-xl font-bold text-white mb-4">Manufacturing Site Details</h2>
            <div class="overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead class="text-xs uppercase bg-white/5">
                        <tr>
                            <th class="px-4 py-3 text-red-300">Site</th>
                            <th class="px-4 py-3 text-red-300">Location</th>
                            <th class="px-4 py-3 text-red-300">Province</th>
                            <th class="px-4 py-3 text-red-300">Product Focus</th>
                            <th class="px-4 py-3 text-red-300">Key Notes</th>
                        </tr>
                    </thead>
                    <tbody id="siteTable" class="text-gray-200">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        // Tesla supply chain data
        const sites = [
            {
                name: "Tesla Gigafactory Shanghai",
                province: "Shanghai",
                city: "Pudong, Lingang",
                lat: 30.89,
                lon: 121.82,
                products: ["Model 3/Y Assembly", "Battery Packs", "Megapack"],
                category: "Final Assembly",
                capacity: "750k+ vehicles",
                notes: "95% localization, 60+ Chinese tier-1 suppliers, exports to Europe/Asia-Pacific"
            },
            {
                name: "CATL Fuding Battery Base",
                province: "Fujian",
                city: "Ningde, Fuding",
                lat: 27.12,
                lon: 120.12,
                products: ["LFP/NMC Battery Cells"],
                category: "Battery Production",
                capacity: "120GWh annual",
                notes: "World's largest Li-ion hub, 80+ upstream chain projects, supplies Tesla Shanghai"
            },
            {
                name: "CATL Liyang Base",
                province: "Jiangsu",
                city: "Liyang (Changzhou)",
                lat: 31.43,
                lon: 119.48,
                products: ["Battery Cells", "Modules", "Packs"],
                category: "Battery Production",
                capacity: "R&D + Production",
                notes: "One of CATL's 13 global bases, provides redundancy to Shanghai operations"
            },
            {
                name: "CATL Lingang Shanghai",
                province: "Shanghai",
                city: "Lingang FTZ",
                lat: 30.88,
                lon: 121.83,
                products: ["Battery Cells"],
                category: "Battery Production",
                capacity: "Just-in-time",
                notes: "Factory within factory model, co-located with Gigafactory for minimal logistics"
            },
            {
                name: "Wuhan Optics Valley SiC",
                province: "Hubei",
                city: "Wuhan, East Lake",
                lat: 30.48,
                lon: 114.42,
                products: ["6-inch SiC Wafers", "Power Modules"],
                category: "Power Electronics",
                capacity: "360k wafers/yr",
                notes: "China's largest SiC factory, 97% yield, for 400V/800V architectures"
            },
            {
                name: "Shaoxing SiC Fab",
                province: "Zhejiang",
                city: "Shaoxing",
                lat: 30.01,
                lon: 120.58,
                products: ["200mm SiC Wafers"],
                category: "Power Electronics",
                capacity: "Volume prod 2025",
                notes: "Reduces dependency on STMicro, part of China's SiC self-sufficiency push"
            },
            {
                name: "Suzhou Industrial Park",
                province: "Jiangsu",
                city: "Suzhou",
                lat: 31.32,
                lon: 120.72,
                products: ["Sensors", "Connectors", "Power Electronics"],
                category: "Components",
                capacity: "High-reliability",
                notes: "Medical-grade ISO facilities, premium EMS, provides supply redundancy"
            }
        ];
        
        // Create Leaflet map
        const map = L.map('mapContainer').setView([30, 115], 5);
       
        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);
        
        // Custom marker colors by category
        const categoryColors = {
            'Final Assembly': '#ef4444',
            'Battery Production': '#eab308',
            'Power Electronics': '#3b82f6',
            'Components': '#10b981'
        };
       
        // Calculate bounds to fit all sites
        const bounds = L.latLngBounds(sites.map(site => [site.lat, site.lon]));
       
        // Add markers for each site
        sites.forEach((site) => {
            const color = categoryColors[site.category];
            const markerHtml = `
                <div style="
                    background-color: ${color};
                    width: 28px;
                    height: 28px;
                    border-radius: 50%;
                    border: 3px solid white;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.4);
                "></div>
            `;
           
            const customIcon = L.divIcon({
                html: markerHtml,
                className: 'custom-marker',
                iconSize: [28, 28],
                iconAnchor: [14, 14]
            });
           
            const popupContent = `
                <div style="color: #1e293b; min-width: 220px;">
                    <h3 style="font-weight: bold; margin-bottom: 8px; color: ${color};">${site.name}</h3>
                    <p style="margin: 4px 0;"><strong>Location:</strong> ${site.city}, ${site.province}</p>
                    <p style="margin: 4px 0;"><strong>Category:</strong> ${site.category}</p>
                    <p style="margin: 4px 0;"><strong>Products:</strong> ${site.products.join(', ')}</p>
                    <p style="margin: 4px 0;"><strong>Capacity:</strong> ${site.capacity}</p>
                    <p style="margin: 4px 0; font-size: 11px; color: #475569;">${site.notes}</p>
                </div>
            `;
           
            L.marker([site.lat, site.lon], { icon: customIcon })
                .bindPopup(popupContent)
                .addTo(map);
        });
       
        // Fit map to show all sites
        map.fitBounds(bounds, { padding: [30, 30] });
       
        // Category distribution pie chart
        const categories = {};
        sites.forEach(site => {
            categories[site.category] = (categories[site.category] || 0) + 1;
        });
        
        const pieData = [{
            type: 'pie',
            labels: Object.keys(categories),
            values: Object.values(categories),
            marker: {
                colors: ['#ef4444', '#eab308', '#3b82f6', '#10b981']
            },
            textinfo: 'label+percent',
            textposition: 'inside',
            hovertemplate: '<b>%{label}</b><br>Sites: %{value}<br>%{percent}<extra></extra>'
        }];
        
        const pieLayout = {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            margin: { t: 20, b: 20, l: 20, r: 20 },
            font: { 
                color: 'white',
                size: 13
            },
            showlegend: true,
            legend: {
                orientation: 'v',
                x: 1,
                y: 0.5,
                font: { color: 'white' }
            }
        };
        
        Plotly.newPlot('productChart', pieData, pieLayout, {responsive: true});
        
        // Populate table
        const tableBody = document.getElementById('siteTable');
        sites.forEach(site => {
            const row = document.createElement('tr');
            row.className = 'border-b border-white/10 hover:bg-white/5';
            const categoryColor = categoryColors[site.category];
            row.innerHTML = `
                <td class="px-4 py-3 font-medium">${site.name}</td>
                <td class="px-4 py-3">${site.city}</td>
                <td class="px-4 py-3">${site.province}</td>
                <td class="px-4 py-3">
                    <span style="color: ${categoryColor}; font-weight: 600;">${site.category}</span><br>
                    <span class="text-xs">${site.products.join(', ')}</span>
                </td>
                <td class="px-4 py-3 text-xs">${site.notes}</td>
            `;
            tableBody.appendChild(row);
        });
    </script>
</body>
</html>
