<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FoodStar Article Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.min.js"></script>
<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:system-ui,-apple-system,sans-serif;background:linear-gradient(to bottom right,#0f172a,#1e293b);color:#fff;min-height:100vh;padding:32px}.container{max-width:1280px;margin:0 auto}.header{margin-bottom:32px}.title{font-size:48px;font-weight:bold;margin-bottom:8px;background:linear-gradient(to right,#60a5fa,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.subtitle{color:#94a3b8;font-size:18px}.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:32px}.card{background:#1e293b;border-radius:8px;padding:24px;border:1px solid #334155}.card-content{display:flex;align-items:center;justify-content:space-between}.card-label{color:#94a3b8;font-size:14px;margin-bottom:4px}.card-value{font-size:30px;font-weight:bold}.charts{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:24px;margin-bottom:32px}.chart-title{font-size:20px;font-weight:bold;margin-bottom:16px}.filters{background:#1e293b;border-radius:8px;padding:24px;border:1px solid #334155;margin-bottom:24px}.filter-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:16px}.input-wrapper{position:relative}.input-icon{position:absolute;left:12px;top:12px;color:#94a3b8}input,select{width:100%;padding:8px 16px 8px 40px;background:#0f172a;border:1px solid #334155;border-radius:8px;color:#fff;outline:none;font-size:14px}input::placeholder{color:#64748b}.filter-count{color:#94a3b8;font-size:14px}table{width:100%;border-collapse:collapse}thead{background:#0f172a}th{padding:12px 24px;text-align:left;font-size:12px;font-weight:500;color:#94a3b8;text-transform:uppercase;letter-spacing:0.05em}tbody tr{border-top:1px solid #334155}tbody tr:hover{background:#334155}td{padding:16px 24px}.topic-badge{padding:4px 8px;font-size:12px;font-weight:600;border-radius:9999px;background:rgba(59,130,246,0.2);color:#93c5fd;white-space:nowrap}.article-title{font-size:14px;max-width:600px}a{color:#60a5fa;text-decoration:underline;font-size:14px}a:hover{color:#93c5fd}.loading{min-height:100vh;display:flex;align-items:center;justify-content:center;font-size:20px}#wordCloud{width:100%;height:300px;display:flex;align-items:center;justify-content:center}.topic-buttons{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:24px}.topic-btn{padding:8px 16px;background:#334155;border:1px solid #475569;border-radius:6px;color:#e2e8f0;font-size:14px;cursor:pointer;transition:all 0.2s}.topic-btn:hover{background:#475569;border-color:#60a5fa}.topic-btn.active{background:#3b82f6;border-color:#3b82f6;color:#fff}.topic-section{margin-bottom:32px}</style>
</head>
<body>
<div id="loading" class="loading">Loading articles...</div>
<div id="app" class="container" style="display:none">
<div class="header"><h1 class="title">FoodStar Article Dashboard</h1><p class="subtitle" id="subtitle"></p></div>
<div class="stats"><div class="card"><div class="card-content"><div><p class="card-label">Total Articles</p><p class="card-value" style="color:#60a5fa" id="totalArticles">0</p></div><svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg></div></div><div class="card"><div class="card-content"><div><p class="card-label">Topics</p><p class="card-value" style="color:#a78bfa" id="totalTopics">0</p></div><svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></div></div><div class="card"><div class="card-content"><div><p class="card-label">Top Topic</p><p class="card-value" style="color:#34d399;font-size:24px" id="topTopic">-</p><p class="card-label" id="topTopicCount">0 articles</p></div><svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg></div></div></div>
<div class="charts"><div class="card"><h2 class="chart-title">Articles by Topic</h2><div id="barChart" style="width:100%;height:300px"></div></div><div class="card"><h2 class="chart-title">Topic Word Cloud</h2><div id="wordCloud"></div></div></div>
<div class="topic-section"><div class="card"><h2 class="chart-title">Browse by Topic</h2><div class="topic-buttons" id="topicButtons"></div></div></div>
<div class="filters"><div class="filter-grid"><div class="input-wrapper"><svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg><input type="text" id="searchInput" placeholder="Search articles..."></div><div class="input-wrapper"><svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg><select id="topicFilter"></select></div></div><p class="filter-count" id="filterCount"></p></div>
<div class="card" style="overflow:hidden"><div style="overflow-x:auto"><table><thead><tr><th>Topic</th><th>Title</th><th>Link</th></tr></thead><tbody id="tableBody"></tbody></table></div></div>
</div>
<script>let articles=[];let searchTerm='';let selectedTopic='All';const colors=['#3b82f6','#ef4444','#10b981','#f59e0b','#8b5cf6','#ec4899','#14b8a6','#f97316','#6366f1','#84cc16','#06b6d4','#a855f7','#eab308','#22c55e','#f43f5e'];const fetchData=async()=>{try{const r=await fetch('https://cdn.jsdelivr.net/gh/ayeeff/fiefdom@main/data/mycontent.csv');const t=await r.text();const lines=t.split('\n');articles=lines.slice(1).filter(l=>l.trim()).map(l=>{const v=l.split(',');return{topic:v[0]?.trim()||'',url:v[1]?.trim()||'',title:v[2]?.trim()||'',notes:v[3]?.trim()||''};}).filter(a=>a.url&&a.title);document.getElementById('loading').style.display='none';document.getElementById('app').style.display='block';updateDashboard();}catch(e){console.error(e);document.getElementById('loading').innerHTML='Error loading data';}};const getTopicCounts=()=>{return articles.reduce((acc,a)=>{acc[a.topic]=(acc[a.topic]||0)+1;return acc;},{});};const getTopicData=()=>{const counts=getTopicCounts();return Object.entries(counts).map(([name,value])=>({name,value})).sort((a,b)=>b.value-a.value);};const renderWordCloud=()=>{const topicData=getTopicData();const words=topicData.map(d=>({text:d.name,size:10+d.value*3}));const layout=d3.layout.cloud().size([400,300]).words(words).padding(5).rotate(()=>~~(Math.random()*2)*90).font('system-ui').fontSize(d=>d.size).on('end',draw);layout.start();function draw(words){d3.select('#wordCloud').html('');const svg=d3.select('#wordCloud').append('svg').attr('width',layout.size()[0]).attr('height',layout.size()[1]).append('g').attr('transform','translate('+layout.size()[0]/2+','+layout.size()[1]/2+')');svg.selectAll('text').data(words).enter().append('text').style('font-size',d=>d.size+'px').style('font-family','system-ui').style('fill',(d,i)=>colors[i%colors.length]).attr('text-anchor','middle').attr('transform',d=>'translate('+[d.x,d.y]+')rotate('+d.rotate+')').text(d=>d.text).style('cursor','pointer').on('click',function(event,d){selectedTopic=d.text;document.getElementById('topicFilter').value=d.text;updateTopicButtons();updateTable();});}};const renderCharts=()=>{const topicData=getTopicData();const barData=[{x:topicData.slice(0,10).map(d=>d.name),y:topicData.slice(0,10).map(d=>d.value),type:'bar',marker:{color:'#3b82f6'}}];const barLayout={paper_bgcolor:'#1e293b',plot_bgcolor:'#1e293b',font:{color:'#e2e8f0'},xaxis:{tickangle:-45},yaxis:{gridcolor:'#374151'},margin:{l:50,r:20,t:20,b:100}};Plotly.newPlot('barChart',barData,barLayout,{responsive:true});renderWordCloud();};const updateStats=()=>{const topicData=getTopicData();const counts=getTopicCounts();document.getElementById('subtitle').textContent=`Exploring ${articles.length} articles across ${Object.keys(counts).length} topics`;document.getElementById('totalArticles').textContent=articles.length;document.getElementById('totalTopics').textContent=Object.keys(counts).length;document.getElementById('topTopic').textContent=topicData[0]?.name||'-';document.getElementById('topTopicCount').textContent=`${topicData[0]?.value||0} articles`;};const updateFilters=()=>{const counts=getTopicCounts();const topics=['All',...Object.keys(counts).sort()];const select=document.getElementById('topicFilter');select.innerHTML=topics.map(t=>`<option value="${t}">${t}</option>`).join('');select.value=selectedTopic;};const updateTopicButtons=()=>{const counts=getTopicCounts();const topics=Object.keys(counts).sort();const container=document.getElementById('topicButtons');container.innerHTML=topics.map((t,i)=>`<button class="topic-btn ${selectedTopic===t?'active':''}" data-topic="${t}" style="background:${selectedTopic===t?'#3b82f6':colors[i%colors.length]+'33'};border-color:${colors[i%colors.length]}">${t} (${counts[t]})</button>`).join('');container.querySelectorAll('.topic-btn').forEach(btn=>{btn.addEventListener('click',()=>{selectedTopic=btn.dataset.topic;document.getElementById('topicFilter').value=selectedTopic;updateTopicButtons();updateTable();});});};const filterArticles=()=>{return articles.filter(a=>{const matchSearch=a.title.toLowerCase().includes(searchTerm.toLowerCase())||a.topic.toLowerCase().includes(searchTerm.toLowerCase());const matchTopic=selectedTopic==='All'||a.topic===selectedTopic;return matchSearch&&matchTopic;});};const updateTable=()=>{const filtered=filterArticles();document.getElementById('filterCount').textContent=`Showing ${filtered.length} of ${articles.length} articles`;const tbody=document.getElementById('tableBody');tbody.innerHTML=filtered.map(a=>`<tr><td><span class="topic-badge">${a.topic}</span></td><td><div class="article-title">${a.title}</div></td><td><a href="${a.url}" target="_blank" rel="noopener noreferrer">View Article</a></td></tr>`).join('');};const updateDashboard=()=>{updateStats();updateFilters();updateTopicButtons();renderCharts();updateTable();};document.addEventListener('DOMContentLoaded',()=>{fetchData();document.getElementById('searchInput').addEventListener('input',(e)=>{searchTerm=e.target.value;updateTable();});document.getElementById('topicFilter').addEventListener('change',(e)=>{selectedTopic=e.target.value;updateTopicButtons();updateTable();});});</script>
</body>
</html>
