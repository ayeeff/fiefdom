<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historical Migration Routes to Australia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, sans-serif;
    }
    #map {
      height: calc(100vh - 140px);
      width: 100%;
    }
  </style>
</head>
<body class="bg-gray-50">
  <header class="bg-white shadow-md p-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-4">Historical Migration Routes to Australia</h1>
    
    <div class="flex gap-3 flex-wrap">
      <button id="btn-second-fleet" class="px-4 py-2 rounded-lg font-medium transition-all bg-red-600 text-white shadow-md">
        Second Fleet (1790)
      </button>
      <button id="btn-guangzhou" class="px-4 py-2 rounded-lg font-medium transition-all bg-gray-200 text-gray-700 hover:bg-gray-300">
        Guangzhou to Ballarat (1850s-60s)
      </button>
    </div>
  </header>

  <main class="relative">
    <div id="map"></div>
    
    <div id="stop-info" class="hidden absolute top-4 right-4 bg-white rounded-lg shadow-xl p-4 max-w-sm" style="z-index: 1000;">
      <button id="close-info" class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-xl font-bold">×</button>
      <h3 id="stop-name" class="font-bold text-lg text-gray-800 mb-2 pr-6"></h3>
      <p id="stop-description" class="text-sm text-gray-600 mb-2"></p>
      <p id="stop-distance" class="text-xs text-gray-500 font-medium"></p>
    </div>

    <div id="route-summary" class="absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-4 max-w-md" style="z-index: 1000;">
      <h3 id="route-title" class="font-bold text-gray-800 mb-2"></h3>
      <div id="route-stats" class="text-sm text-gray-600 space-y-1"></div>
    </div>
  </main>

  <footer class="bg-gray-800 text-white p-6 mt-auto">
    <div class="max-w-6xl mx-auto">
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          <h3 class="font-bold text-lg mb-2">About These Routes</h3>
          <p class="text-sm text-gray-300">
            These maps trace two significant migration journeys to Australia: the brutal Second Fleet convict voyage of 1790, 
            and the arduous journey of Chinese gold miners in the 1850s-60s who traveled from Guangzhou to the Ballarat goldfields.
          </p>
        </div>
        <div>
          <h3 class="font-bold text-lg mb-2">Historical Context</h3>
          <p class="text-sm text-gray-300">
            The Second Fleet had a 26% mortality rate, while Chinese miners faced discrimination and harsh conditions 
            during their 500km overland walk. These journeys shaped Australia's multicultural history.
          </p>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
  <script>
    var routes = {
      'second-fleet': {
        name: 'Second Fleet Route (1790)',
        color: '#dc2626',
        stats: '<p>• Journey: 158-160 days (January-June 1790)</p><p>• Distance: ~18,000-20,000 nautical miles</p><p>• Mortality: 26% (~160 deaths)</p><p>• Ships: Neptune, Scarborough, Surprize</p>',
        stops: [
          { name: 'Portsmouth, England', lat: 50.8198, lng: -1.0880, info: 'Departed January 19, 1790', distance: 'Start' },
          { name: 'Tenerife, Canary Islands', lat: 28.4636, lng: -16.2518, info: 'Brief water stop, 10-14 days', distance: '~1,200 nm from Portsmouth' },
          { name: 'Cape Town, South Africa', lat: -33.9249, lng: 18.4241, info: 'Arrived April 13-22, 1790. High mortality, 30-40 day resupply', distance: '~5,500 nm from Tenerife' },
          { name: 'Sydney Cove, Australia', lat: -33.8568, lng: 151.2153, info: 'Arrived June 26-28, 1790. ~160 deaths total', distance: '~6,000 nm from Cape Town' }
        ]
      },
      'guangzhou-ballarat': {
        name: 'Guangzhou to Ballarat (1850s-1860s)',
        color: '#2563eb',
        stats: '<p>• Journey: 3-5 months total (1850s-1860s)</p><p>• Sea voyage: 70-90 days (~10,000 km)</p><p>• Overland walk: 4-5 weeks (~500 km)</p><p>• Total migrants: ~17,000 via Robe</p>',
        stops: [
          { name: 'Guangzhou/Hong Kong, China', lat: 23.1291, lng: 113.2644, info: 'Departure point, 70-90 day voyage', distance: 'Start' },
          { name: 'Robe, South Australia', lat: -37.1625, lng: 139.7583, info: 'Landed 1856-1863, ~17,000 migrants', distance: '~6,000 nm (~10,000 km)' },
          { name: 'Lake Hawdon/Penola', lat: -37.3772, lng: 140.8394, info: 'First camps, 3-5 days walk', distance: '50-60 km from Robe' },
          { name: 'Casterton', lat: -37.5863, lng: 141.4003, info: 'Crossed Glenelg River, 5-7 days', distance: '80-100 km' },
          { name: 'Hamilton', lat: -37.7427, lng: 142.0156, info: 'Resupplied at inns, faced discrimination', distance: '80-100 km' },
          { name: 'Dunkeld', lat: -37.6500, lng: 142.3333, info: 'Volcanic plains, rising sickness', distance: '60-70 km' },
          { name: 'Skipton/Linton', lat: -37.6833, lng: 143.3667, info: 'Grampians foothills, 7-8 days', distance: '100-110 km' },
          { name: 'Smythesdale', lat: -37.7167, lng: 143.7667, info: 'Approaching goldfields, 5-6 days', distance: '80-90 km' },
          { name: 'Ballarat', lat: -37.5622, lng: 143.8503, info: 'Final destination, ~9,000 Chinese by 1858', distance: '50-60 km' }
        ]
      }
    };

    var map;
    var currentRoute = 'second-fleet';
    var markers = [];
    var polyline;

    function initMap() {
      map = L.map('map', {
        center: [-20, 100],
        zoom: 3,
        minZoom: 2,
        maxZoom: 10
      });

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      drawRoute(currentRoute);
    }

    function drawRoute(routeId) {
      var i;
      var len = markers.length;
      for (i = 0; i < len; i++) {
        map.removeLayer(markers[i]);
      }
      markers = [];
      
      if (polyline) {
        map.removeLayer(polyline);
      }

      var route = routes[routeId];
      var coordinates = [];
      var stopsLen = route.stops.length;
      
      for (i = 0; i < stopsLen; i++) {
        coordinates.push([route.stops[i].lat, route.stops[i].lng]);
      }

      polyline = L.polyline(coordinates, {
        color: route.color,
        weight: 3,
        opacity: 0.7
      }).addTo(map);

      for (i = 0; i < stopsLen; i++) {
        var stop = route.stops[i];
        var index = i + 1;
        var markerHtml = '<div style="background-color: ' + route.color + '; width: 24px; height: 24px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 12px;">' + index + '</div>';
        
        var marker = L.marker([stop.lat, stop.lng], {
          icon: L.divIcon({
            className: 'custom-marker',
            html: markerHtml,
            iconSize: [24, 24],
            iconAnchor: [12, 12]
          })
        }).addTo(map);

        marker.stopData = stop;
        marker.on('click', function(e) {
          showStopInfo(e.target.stopData);
        });
        markers.push(marker);
      }

      map.fitBounds(polyline.getBounds(), { padding: [50, 50] });

      document.getElementById('route-title').textContent = route.name;
      document.getElementById('route-stats').innerHTML = route.stats;
    }

    function showStopInfo(stop) {
      document.getElementById('stop-name').textContent = stop.name;
      document.getElementById('stop-description').textContent = stop.info;
      document.getElementById('stop-distance').textContent = 'Distance: ' + stop.distance;
      document.getElementById('stop-info').classList.remove('hidden');
    }

    document.getElementById('btn-second-fleet').addEventListener('click', function() {
      currentRoute = 'second-fleet';
      drawRoute(currentRoute);
      document.getElementById('btn-second-fleet').className = 'px-4 py-2 rounded-lg font-medium transition-all bg-red-600 text-white shadow-md';
      document.getElementById('btn-guangzhou').className = 'px-4 py-2 rounded-lg font-medium transition-all bg-gray-200 text-gray-700 hover:bg-gray-300';
      document.getElementById('stop-info').classList.add('hidden');
    });

    document.getElementById('btn-guangzhou').addEventListener('click', function() {
      currentRoute = 'guangzhou-ballarat';
      drawRoute(currentRoute);
      document.getElementById('btn-guangzhou').className = 'px-4 py-2 rounded-lg font-medium transition-all bg-blue-600 text-white shadow-md';
      document.getElementById('btn-second-fleet').className = 'px-4 py-2 rounded-lg font-medium transition-all bg-gray-200 text-gray-700 hover:bg-gray-300';
      document.getElementById('stop-info').classList.add('hidden');
    });

    document.getElementById('close-info').addEventListener('click', function() {
      document.getElementById('stop-info').classList.add('hidden');
    });

    window.addEventListener('load', initMap);
  </script>
</body>
</html>
