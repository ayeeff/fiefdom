<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valve Steam Production Map</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; background: #0a0e27; color: #e0e7ff; }
        .gradient-bg { background: linear-gradient(135deg, #1a1f3a 0%, #0a0e27 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(99, 102, 241, 0.3); }
        
        #mapContainer {
            position: relative;
            width: 100%;
            height: 700px;
            background: #1e293b;
            border-radius: 8px;
            overflow: hidden;
        }
        
        path.province {
            fill: #334155;
            stroke: #475569;
            stroke-width: 1;
            transition: all 0.3s ease;
        }
        
        path.province:hover {
            fill: #475569;
        }
        
        .manufacturing-marker {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .manufacturing-marker:hover {
            transform: scale(1.2);
        }
        
        .marker-glow {
            filter: drop-shadow(0 0 8px currentColor);
        }
        
        .marker-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.15); }
        }
        
        .connection-line {
            stroke: #a855f7;
            stroke-width: 2;
            stroke-dasharray: 5,5;
            fill: none;
            opacity: 0.4;
        }
        
        .marker-label {
            font-size: 11px;
            font-weight: 600;
            pointer-events: none;
            text-shadow: 0 0 4px rgba(0,0,0,0.8);
        }
        
        .province-label {
            font-size: 16px;
            font-weight: bold;
            fill: rgba(255,255,255,0.15);
            pointer-events: none;
        }
    </style>
</head>
<body class="gradient-bg">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">
                China Electronics Manufacturing Zones
            </h1>
            <p class="text-xl text-indigo-300">Valve Steam Product Production Analysis</p>
        </div>

        <!-- Key Insights Banner -->
        <div class="bg-gradient-to-r from-indigo-900 to-purple-900 rounded-lg p-6 mb-6 border border-indigo-500/30">
            <h2 class="text-2xl font-bold mb-4 text-yellow-300">üéØ Bottom Line: Where Steam Deck Actually Gets Made</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                    <p class="mb-2"><span class="font-semibold text-blue-300">Final Assembly:</span> Dongguan Songshan Lake</p>
                    <p class="mb-2"><span class="font-semibold text-blue-300">APU/SoC:</span> AMD Tianjin/China partner fab</p>
                    <p class="mb-2"><span class="font-semibold text-blue-300">Display:</span> Samsung/BOE ‚Üí Dongguan</p>
                </div>
                <div>
                    <p class="mb-2"><span class="font-semibold text-blue-300">SSD:</span> Suzhou Industrial Park</p>
                    <p class="mb-2"><span class="font-semibold text-blue-300">Controllers:</span> Shenzhen Bao'an</p>
                    <p class="mb-2"><span class="font-semibold text-blue-300">Prototyping:</span> Shenzhen Nanshan</p>
                </div>
            </div>
            <div class="mt-4 p-3 bg-black/30 rounded border-l-4 border-yellow-400">
                <p class="text-yellow-200"><strong>Why not Foxconn?</strong> Valve's 4M lifetime Deck units = 8 days of iPhone output. Foxconn's 10M+ unit MOQ is incompatible with boutique ODMs specialized in 50k-500k runs with direct engineering support.</p>
            </div>
        </div>

        <!-- Map Container -->
        <div class="bg-gray-900/50 rounded-lg p-4 mb-6 backdrop-blur border border-indigo-500/20">
            <div class="text-center mb-3">
                <h3 class="text-lg font-semibold text-indigo-300">Geographic Distribution Map</h3>
                <p class="text-xs text-gray-400">Interactive China map showing manufacturing zones ‚Ä¢ Click markers for details</p>
            </div>
            <div id="mapContainer"></div>
        </div>

        <!-- Site Details Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
            <!-- Zhengzhou -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-red-500/30" id="card-zhengzhou">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-red-400">Zhengzhou Airport Zone</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Henan Province ‚Ä¢ 34.53¬∞N, 113.83¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">iPhone, Smartphones</span></p>
                <p class="text-xs text-gray-300">"iPhone City" - Foxconn's 300k+ worker facility. 500k iPhones/day. Valve's 4M Deck sales = "sample run" territory. Not viable for mid-tier hardware.</p>
            </div>

            <!-- Shenzhen Bao'an -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-green-500/30" id="card-baoan">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-green-400">Shenzhen Bao'an</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Guangdong Province ‚Ä¢ 22.64¬∞N, 113.81¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">Handhelds, Controllers</span></p>
                <p class="text-xs text-gray-300">Heart of "Silicon Valley of Hardware." 30k+ factories. Home to Ayaneo, GPD, OneXPlayer. Perfect for 50k-500k runs. 24-hour component turnaround.</p>
            </div>

            <!-- Shenzhen Nanshan -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-blue-500/30" id="card-nanshan">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-blue-400">Shenzhen Nanshan Tech Park</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Guangdong Province ‚Ä¢ 22.56¬∞N, 113.97¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">R&D, Prototypes</span></p>
                <p class="text-xs text-gray-300">HQ of Tencent, DJI, Huawei. Premium development. Higher costs but unmatched R&D ecosystem. Steam Deck's initial development phase.</p>
            </div>

            <!-- Dongguan -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border-2 border-purple-500/70" id="card-dongguan">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-purple-500 rounded-full mr-2 animate-pulse"></div>
                    <h3 class="text-lg font-bold text-purple-400">Dongguan Songshan Lake ‚≠ê</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Guangdong Province ‚Ä¢ 23.05¬∞N, 113.74¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">Steam Deck Production</span></p>
                <p class="text-xs text-gray-300"><strong>MOST PROBABLE SITE.</strong> Huawei's ¬•100B+ cluster. 4,000+ tech enterprises. Cheaper than Shenzhen with same supply chain. 100k-1M unit sweet spot.</p>
            </div>

            <!-- Guangzhou -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-yellow-500/30" id="card-guangzhou">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-yellow-400">Guangzhou Science City</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Guangdong Province ‚Ä¢ 23.18¬∞N, 113.47¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">Automotive, Displays</span></p>
                <p class="text-xs text-gray-300">Less relevant for handhelds. Focus on automotive infotainment. Higher MOQs. Better for Steam Machine-scale devices.</p>
            </div>

            <!-- Suzhou -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-cyan-500/30" id="card-suzhou">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-cyan-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-cyan-400">Suzhou Industrial Park</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Jiangsu Province ‚Ä¢ 31.32¬∞N, 120.72¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">SSDs, Semiconductors</span></p>
                <p class="text-xs text-gray-300">Yangtze River Delta hub. Premium EMS: Spellman, TE Connectivity. ISO 13485 medical-grade. 20-30% higher costs. Steam Deck SSD suppliers.</p>
            </div>

            <!-- Kunshan -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-teal-500/30" id="card-kunshan">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-teal-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-teal-400">Kunshan</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Jiangsu Province ‚Ä¢ 31.39¬∞N, 120.96¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">PCBA, Connectors</span></p>
                <p class="text-xs text-gray-300">"Mini-SIP." 60% of world's laptop connectors. Supplies Bao'an assembly houses. Too component-focused for final assembly.</p>
            </div>

            <!-- Chongqing -->
            <div class="bg-gray-800/60 rounded-lg p-5 card-hover border border-orange-500/30" id="card-chongqing">
                <div class="flex items-center mb-3">
                    <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                    <h3 class="text-lg font-bold text-orange-400">Chongqing Xiyong</h3>
                </div>
                <p class="text-xs text-gray-400 mb-2">Chongqing Municipality ‚Ä¢ 29.56¬∞N, 106.46¬∞E</p>
                <p class="text-sm mb-3"><span class="font-semibold text-yellow-300">Laptops, IT Hardware</span></p>
                <p class="text-xs text-gray-300">"Laptop Capital" - 100M+ notebooks/year. Built for 5M+ unit contracts. Inland logistics add 3-5 days. Coastal Guangdong better for handhelds.</p>
            </div>
        </div>

        <!-- Product Distribution -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-gray-800/60 rounded-lg p-6 border border-indigo-500/20">
                <h3 class="text-xl font-bold mb-4 text-indigo-300">üéÆ Steam Product Manufacturing</h3>
                <div class="space-y-3 text-sm">
                    <div class="flex items-center justify-between p-3 bg-purple-900/30 rounded">
                        <span class="font-semibold">Steam Deck</span>
                        <span class="text-purple-400">Dongguan (Final)</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-green-900/30 rounded">
                        <span class="font-semibold">Steam Controller</span>
                        <span class="text-green-400">Shenzhen Bao'an</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-blue-900/30 rounded">
                        <span class="font-semibold">Steam Frame (Prototype)</span>
                        <span class="text-blue-400">Shenzhen Nanshan</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-yellow-900/30 rounded">
                        <span class="font-semibold">Steam Machine</span>
                        <span class="text-yellow-400">Guangzhou (Theoretical)</span>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800/60 rounded-lg p-6 border border-indigo-500/20">
                <h3 class="text-xl font-bold mb-4 text-indigo-300">üìä Production Scale Comparison</h3>
                <div class="space-y-3 text-sm">
                    <div>
                        <div class="flex justify-between mb-1">
                            <span>Zhengzhou (iPhone)</span>
                            <span class="text-red-400">100M+ units/year</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="bg-red-500 h-2 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span>Chongqing (Laptops)</span>
                            <span class="text-orange-400">5M-100M units</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="bg-orange-500 h-2 rounded-full" style="width: 80%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span>Dongguan (Steam Deck)</span>
                            <span class="text-purple-400">100k-1M units</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="bg-purple-500 h-2 rounded-full" style="width: 30%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span>Shenzhen Bao'an (Controllers)</span>
                            <span class="text-green-400">50k-500k units</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 20%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-sm text-gray-400">
            <p>Data based on supply chain analysis and hardware teardowns. Map: D3.js v5</p>
        </div>
    </div>

    <script>
        const sites = [
            {id: 'zhengzhou', name: 'Zhengzhou', lat: 34.5333, lon: 113.8311, color: '#ef4444', size: 14, label: 'Zhengzhou\n(iPhone)', card: 'card-zhengzhou'},
            {id: 'baoan', name: 'Shenzhen Bao\'an', lat: 22.6383, lon: 113.8106, color: '#22c55e', size: 12, label: 'Bao\'an\n(Controllers)', card: 'card-baoan'},
            {id: 'nanshan', name: 'Shenzhen Nanshan', lat: 22.5583, lon: 113.9718, color: '#3b82f6', size: 11, label: 'Nanshan\n(R&D)', card: 'card-nanshan'},
            {id: 'dongguan', name: 'Dongguan ‚òÖ', lat: 23.0489, lon: 113.7447, color: '#a855f7', size: 16, label: 'Dongguan ‚òÖ\n(Steam Deck)', pulse: true, card: 'card-dongguan'},
            {id: 'guangzhou', name: 'Guangzhou', lat: 23.1833, lon: 113.4667, color: '#eab308', size: 10, label: 'Guangzhou\n(Auto)', card: 'card-guangzhou'},
            {id: 'suzhou', name: 'Suzhou', lat: 31.3247, lon: 120.7193, color: '#06b6d4', size: 12, label: 'Suzhou\n(SSDs)', card: 'card-suzhou'},
            {id: 'kunshan', name: 'Kunshan', lat: 31.3890, lon: 120.9626, color: '#14b8a6', size: 9, label: 'Kunshan\n(Parts)', card: 'card-kunshan'},
            {id: 'chongqing', name: 'Chongqing', lat: 29.5630, lon: 106.4574, color: '#f97316', size: 13, label: 'Chongqing\n(Laptops)', card: 'card-chongqing'}
        ];

        const width = document.getElementById('mapContainer').offsetWidth;
        const height = 700;

        const projection = d3.geoMercator()
            .center([110, 35])
            .scale(800)
            .translate([width / 2, height / 2]);

        const path = d3.geoPath().projection(projection);

        const svg = d3.select('#mapContainer')
            .append('svg')
            .attr('width', width)
            .attr('height', height);

        // Load China map GeoJSON
        d3.json('https://raw.githubusercontent.com/BarbarossaWang/cn-atlas/master/provinces.json')
            .then(function(geojson) {
                const features = geojson.features;
                // Draw provinces
                svg.selectAll('path.province')
                    .data(features)
                    .enter()
                    .append('path')
                    .attr('class', 'province')
                    .attr('d', path);

                // Add province labels for key regions
                const provinceLabels = [
                    {name: 'Henan', lat: 34.5, lon: 113.5},
                    {name: 'Guangdong', lat: 23.5, lon: 113.5},
                    {name: 'Jiangsu', lat: 32, lon: 120},
                    {name: 'Chongqing', lat: 29.5, lon: 107}
                ];

                svg.selectAll('.province-label')
                    .data(provinceLabels)
                    .enter()
                    .append('text')
                    .attr('class', 'province-label')
                    .attr('x', d => projection([d.lon, d.lat])[0])
                    .attr('y', d => projection([d.lon, d.lat])[1])
                    .attr('text-anchor', 'middle')
                    .text(d => d.name);

                // Draw connection lines from Dongguan
                const dongguan = sites.find(s => s.id === 'dongguan');
                const connections = ['suzhou', 'baoan', 'nanshan'];
                
                connections.forEach(targetId => {
                    const target = sites.find(s => s.id === targetId);
                    const dongguanPos = projection([dongguan.lon, dongguan.lat]);
                    const targetPos = projection([target.lon, target.lat]);
                    
                    svg.append('line')
                        .attr('class', 'connection-line')
                        .attr('x1', dongguanPos[0])
                        .attr('y1', dongguanPos[1])
                        .attr('x2', targetPos[0])
                        .attr('y2', targetPos[1]);
                });

                // Draw manufacturing markers
                const markers = svg.selectAll('.manufacturing-marker')
                    .data(sites)
                    .enter()
                    .append('g')
                    .attr('class', 'manufacturing-marker')
                    .attr('transform', d => {
                        const pos = projection([d.lon, d.lat]);
                        return `translate(${pos[0]}, ${pos[1]})`;
                    })
                    .on('click', function(d) {
                        document.getElementById(d.card).scrollIntoView({behavior: 'smooth', block: 'nearest'});
                        d3.select('#' + d.card)
                            .style('box-shadow', `0 0 30px ${d.color}`)
                            .transition()
                            .duration(2000)
                            .style('box-shadow', '');
                    });

                // Add glow circles
                markers.append('circle')
                    .attr('r', d => d.size * 1.5)
                    .attr('fill', d => d.color)
                    .attr('opacity', 0.2)
                    .attr('class', d => d.pulse ? 'marker-pulse' : '');

                // Add main circles
                markers.append('circle')
                    .attr('r', d => d.size)
                    .attr('fill', d => d.color)
                    .attr('class', 'marker-glow')
                    .attr('stroke', '#fff')
                    .attr('stroke-width', 2);

                // Add labels
                markers.each(function(d) {
                    const lines = d.label.split('\n');
                    const g = d3.select(this);
                    
                    lines.forEach((line, i) => {
                        g.append('text')
                            .attr('class', 'marker-label')
                            .attr('y', d.size + 15 + (i * 12))
                            .attr('text-anchor', 'middle')
                            .attr('fill', d.color)
                            .text(line);
                    });
                });
            })
            .catch(error => {
                console.error('Error loading map:', error);
                document.getElementById('mapContainer').innerHTML = 
                    '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;">Map loading failed. Please refresh the page.</div>';
            });
    </script>
</body>
</html>
