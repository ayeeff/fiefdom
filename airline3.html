<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Airlines Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="//unpkg.com/globe.gl"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>.orbitron { font-family: 'Orbitron', monospace; } .speed-card { background: linear-gradient(to bottom right, rgba(31, 41, 55, 0.8), rgba(15, 23, 42, 0.8)); backdrop-filter: blur(10px); border: 1px solid rgba(148, 163, 184, 0.2); } @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } } .shimmer-text { background-size: 200% 100%; animation: shimmer 2s linear infinite; } .country-btn, .airline-btn { transition: all 0.2s; } .country-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); } .airline-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4); } .modal-item { cursor: pointer; transition: all 0.2s; } .modal-item:hover { background: rgba(59, 130, 246, 0.1); } #globeViz { position: relative; overflow: hidden; } #globeViz canvas { max-width: 100% !important; max-height: 600px !important; } .region-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; } .tab-button { transition: all 0.2s; } .tab-button:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3); } .tab-button.rank-1 { background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 165, 0, 0.2)); border-color: rgba(255, 215, 0, 0.5); } .tab-button.rank-2 { background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(169, 169, 169, 0.2)); border-color: rgba(192, 192, 192, 0.5); } .tab-button.rank-3 { background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(184, 115, 51, 0.2)); border-color: rgba(205, 127, 50, 0.5); }</style>
</head>
<body class="bg-gradient-to-br from-slate-900 to-slate-800 min-h-screen text-white">
    <div class="container mx-auto p-4">
        <div class="mb-6 speed-card p-6 rounded-xl">
            <h1 class="text-4xl md:text-6xl font-black mb-4 text-center orbitron bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent shimmer-text">Global Airlines Network</h1>
            <p class="text-center text-gray-300 text-sm">Explore <span id="totalAirlines" class="font-bold text-blue-400">0</span> major airlines serving <span id="totalCountries" class="font-bold text-purple-400">0</span> countries worldwide</p>
        </div>
        <div id="loading" class="text-center py-12">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
            <p class="mt-4 text-gray-400">Loading airline data...</p>
        </div>
        <div id="mainContent" class="hidden">
            <div class="mb-6 speed-card p-6 rounded-xl">
                <h2 class="text-2xl font-bold orbitron mb-4 text-cyan-400">Connectivity Score</h2>
                <p class="text-sm text-gray-400 mb-4">Top 50 countries ranked by airline connections</p>
                <div id="connectivityContent" class=""></div>
            </div>

            <div class="mb-6 speed-card p-6 rounded-xl">
                <h2 class="text-2xl font-bold orbitron mb-4 text-blue-400">Countries Served by Airlines</h2>
                <div class="flex flex-col lg:flex-row gap-4">
                    <div id="globeViz" class="flex-1" style="height: 600px;"></div>
                    <div class="lg:w-48 space-y-3">
                        <div class="text-sm font-bold text-gray-300 mb-3">Airlines per Country</div>
                        <div class="space-y-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded" style="background: rgba(236, 72, 153, 0.9);"></div>
                                <span class="text-xs text-gray-300">Very High (40+)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded" style="background: rgba(217, 70, 239, 0.9);"></div>
                                <span class="text-xs text-gray-300">High (30-40)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded" style="background: rgba(139, 92, 246, 0.9);"></div>
                                <span class="text-xs text-gray-300">Medium (20-30)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded" style="background: rgba(59, 130, 246, 0.9);"></div>
                                <span class="text-xs text-gray-300">Low (10-20)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded" style="background: rgba(51, 65, 85, 0.9);"></div>
                                <span class="text-xs text-gray-300">Very Low (1-10)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded border border-slate-600" style="background: rgba(30, 41, 55, 0.8);"></div>
                                <span class="text-xs text-gray-300">No Service</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-6 speed-card p-6 rounded-xl">
                <h2 class="text-2xl font-bold orbitron mb-4 text-orange-400">Airline Market Share by Region</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <h3 class="text-lg font-bold text-blue-400 mb-3">Asia-Pacific</h3>
                        <div id="regionAsiaPacific" class="space-y-1.5"></div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-purple-400 mb-3">Europe</h3>
                        <div id="regionEurope" class="space-y-1.5"></div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-orange-400 mb-3">Middle East</h3>
                        <div id="regionMiddleEast" class="space-y-1.5"></div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-green-400 mb-3">Americas</h3>
                        <div id="regionAmericas" class="space-y-1.5"></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="speed-card p-6 rounded-xl">
                    <h2 class="text-2xl font-bold orbitron mb-4 text-purple-400">Browse by Country</h2>
                    <div class="mb-4">
                        <input type="text" id="searchInput" placeholder="Search countries..." class="w-full px-4 py-2 bg-slate-800/50 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500">
                    </div>
                    <div id="countriesGrid" class="grid grid-cols-2 gap-2 max-h-96 overflow-y-auto"></div>
                </div>

                <div class="speed-card p-6 rounded-xl">
                    <h2 class="text-2xl font-bold orbitron mb-4 text-green-400">Browse by Airline</h2>
                    <div class="mb-4">
                        <input type="text" id="searchAirlineInput" placeholder="Search airlines..." class="w-full px-4 py-2 bg-slate-800/50 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-green-500">
                    </div>
                    <div id="airlinesGrid" class="grid grid-cols-2 gap-2 max-h-96 overflow-y-auto"></div>
                </div>
            </div>
        </div>

        <div id="infoModal" class="fixed inset-0 bg-black/70 hidden flex items-center justify-center z-50 p-4" onclick="closeModal()">
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 p-6 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-slate-600/50" onclick="event.stopPropagation()">
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <h3 id="modalTitle" class="text-3xl font-black orbitron text-white mb-2"></h3>
                        <p id="modalSubtitle" class="text-sm text-gray-400"></p>
                    </div>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                </div>
                <div id="modalContent"></div>
            </div>
        </div>
    </div>
    <script>
        let airlineData = [];
        let countryAirlines = {};
        let globe;
        let regionMapping = {};
        let currentRegion = 'Asia-Pacific';

        const regionCountries = { 'Asia-Pacific': ['China', 'Japan', 'South Korea', 'India', 'Australia', 'Singapore', 'Thailand', 'Malaysia', 'Indonesia', 'Philippines', 'Vietnam', 'New Zealand', 'Taiwan', 'Hong Kong', 'Pakistan', 'Bangladesh', 'Sri Lanka', 'Nepal', 'Myanmar', 'Cambodia', 'Laos', 'Mongolia', 'Brunei', 'Maldives', 'Fiji', 'Papua New Guinea'], 'Europe': ['United Kingdom', 'Germany', 'France', 'Spain', 'Italy', 'Netherlands', 'Switzerland', 'Belgium', 'Austria', 'Portugal', 'Greece', 'Poland', 'Czech Republic', 'Hungary', 'Romania', 'Bulgaria', 'Croatia', 'Serbia', 'Sweden', 'Norway', 'Denmark', 'Finland', 'Ireland', 'Iceland', 'Luxembourg', 'Malta', 'Cyprus', 'Slovakia', 'Slovenia', 'Estonia', 'Latvia', 'Lithuania', 'Albania', 'North Macedonia', 'Bosnia and Herzegovina', 'Montenegro', 'Kosovo'], 'Middle East': ['United Arab Emirates', 'Saudi Arabia', 'Qatar', 'Kuwait', 'Oman', 'Bahrain', 'Israel', 'Jordan', 'Lebanon', 'Iraq', 'Iran', 'Turkey', 'Yemen', 'Syria', 'Egypt'], 'Americas': ['United States', 'Canada', 'Mexico', 'Brazil', 'Argentina', 'Chile', 'Colombia', 'Peru', 'Venezuela', 'Ecuador', 'Bolivia', 'Uruguay', 'Paraguay', 'Costa Rica', 'Panama', 'Guatemala', 'Honduras', 'El Salvador', 'Nicaragua', 'Jamaica', 'Dominican Republic', 'Cuba', 'Haiti', 'Trinidad and Tobago', 'Bahamas', 'Barbados', 'Belize', 'Guyana', 'Suriname'] };

        async function loadData() { try { const response = await fetch('https://cdn.jsdelivr.net/gh/ayeeff/fiefdom@latest/data/air.csv'); const csvText = await response.text(); Papa.parse(csvText, { header: true, skipEmptyLines: true, complete: function(results) { airlineData = results.data; processData(); renderDashboard(); } }); } catch (error) { console.error('Error loading data:', error); document.getElementById('loading').innerHTML = '<p class="text-red-400">Error loading data. Please try again.</p>'; } }

        function processData() { countryAirlines = {}; regionMapping = {}; airlineData.forEach(airline => { const countries = airline['Countries Served'].split(',').map(c => c.trim()); const origin = airline['Country of Origin'].trim(); let airlineRegion = 'Other'; for (const [region, regionCountriesList] of Object.entries(regionCountries)) { if (regionCountriesList.includes(origin)) { airlineRegion = region; break; } } regionMapping[airline.Airline] = { region: airlineRegion, origin: origin }; countries.forEach(country => { if (!countryAirlines[country]) { countryAirlines[country] = []; } countryAirlines[country].push({ airline: airline.Airline, origin: origin, totalCountries: parseInt(airline['Number of Countries']), region: airlineRegion }); }); }); }

        function renderDashboard() { document.getElementById('loading').classList.add('hidden'); document.getElementById('mainContent').classList.remove('hidden'); document.getElementById('totalAirlines').textContent = airlineData.length; document.getElementById('totalCountries').textContent = Object.keys(countryAirlines).length; renderMap(); renderCountriesGrid(); renderAirlinesGrid(); renderRegionMarketShare(); renderConnectivityScore(); setupSearch(); setupAirlineSearch(); }

        function renderMap() { const countries = Object.keys(countryAirlines); const airlineCounts = countries.map(c => countryAirlines[c].length); const maxCount = Math.max(...airlineCounts); fetch('https://raw.githubusercontent.com/vasturiano/globe.gl/master/example/datasets/ne_110m_admin_0_countries.geojson').then(res => res.json()).then(landPolygons => { const countryData = {}; countries.forEach(country => { countryData[country] = countryAirlines[country].length; }); const getColor = (count) => { if (!count) return 'rgba(30, 41, 55, 0.8)'; const ratio = count / maxCount; if (ratio <= 0.2) return 'rgba(51, 65, 85, 0.9)'; if (ratio <= 0.4) return 'rgba(59, 130, 246, 0.9)'; if (ratio <= 0.6) return 'rgba(139, 92, 246, 0.9)'; if (ratio <= 0.8) return 'rgba(217, 70, 239, 0.9)'; return 'rgba(236, 72, 153, 0.9)'; }; const normalizeCountryName = (name) => { if (name === 'United States of America') return 'United States'; return name; }; const container = document.getElementById('globeViz'); globe = Globe()(container).width(container.offsetWidth).height(600).globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg').backgroundImageUrl('//unpkg.com/three-globe/example/img/night-sky.png').polygonsData(landPolygons.features.filter(d => d.properties.ISO_A2 !== 'AQ')).polygonAltitude(d => { const name = normalizeCountryName(d.properties.ADMIN || d.properties.NAME); return countryData[name] ? 0.01 : 0.001; }).polygonCapColor(d => { const name = normalizeCountryName(d.properties.ADMIN || d.properties.NAME); return getColor(countryData[name]); }).polygonSideColor(() => 'rgba(0, 0, 0, 0.1)').polygonStrokeColor(() => '#475569').polygonLabel(d => { const name = normalizeCountryName(d.properties.ADMIN || d.properties.NAME); const count = countryData[name]; if (count) { return `<div class="bg-slate-900/95 px-3 py-2 rounded-lg border border-slate-600"><div class="font-bold text-white">${name}</div><div class="text-sm text-blue-400">${count} airline${count !== 1 ? 's' : ''}</div></div>`; } return `<div class="bg-slate-900/95 px-3 py-2 rounded-lg border border-slate-600"><div class="font-bold text-white">${name}</div></div>`; }).onPolygonClick(d => { const name = normalizeCountryName(d.properties.ADMIN || d.properties.NAME); if (countryData[name]) { showCountryModal(name); } }).polygonsTransitionDuration(300); globe.controls().autoRotate = true; globe.controls().autoRotateSpeed = 1.5; globe.pointOfView({ altitude: 1 }); window.addEventListener('resize', () => { globe.width(container.offsetWidth); }); }); }

        function renderCountriesGrid(filter = '') { const grid = document.getElementById('countriesGrid'); const countries = Object.keys(countryAirlines).sort(); const filtered = filter ? countries.filter(c => c.toLowerCase().includes(filter.toLowerCase())) : countries; grid.innerHTML = filtered.map(country => { const count = countryAirlines[country].length; return `<button onclick="showCountryModal('${country.replace(/'/g, "\\'")}')" class="country-btn px-3 py-2 bg-gradient-to-br from-blue-600/20 to-purple-600/20 hover:from-blue-600/40 hover:to-purple-600/40 border border-blue-500/30 rounded-lg text-left"><div class="font-semibold text-white text-sm">${country}</div><div class="text-xs text-gray-400">${count} airline${count !== 1 ? 's' : ''}</div></button>`; }).join(''); }

        function renderAirlinesGrid(filter = '') { const grid = document.getElementById('airlinesGrid'); const sortedAirlines = [...airlineData].sort((a, b) => parseInt(b['Number of Countries']) - parseInt(a['Number of Countries'])); const filtered = filter ? sortedAirlines.filter(a => a.Airline.toLowerCase().includes(filter.toLowerCase()) || a['Country of Origin'].toLowerCase().includes(filter.toLowerCase())) : sortedAirlines; grid.innerHTML = filtered.map(airline => { const numCountries = airline['Number of Countries']; const region = regionMapping[airline.Airline]?.region || 'Other'; const regionColors = { 'Asia-Pacific': 'bg-blue-500/20 text-blue-300', 'Europe': 'bg-purple-500/20 text-purple-300', 'Middle East': 'bg-orange-500/20 text-orange-300', 'Americas': 'bg-green-500/20 text-green-300', 'Other': 'bg-gray-500/20 text-gray-300' }; return `<button onclick="showAirlineModal('${airline.Airline.replace(/'/g, "\\'")}', '${airline['Country of Origin'].replace(/'/g, "\\'")}') " class="airline-btn px-3 py-2 bg-gradient-to-br from-green-600/20 to-blue-600/20 hover:from-green-600/40 hover:to-blue-600/40 border border-green-500/30 rounded-lg text-left"><div class="font-semibold text-white text-sm">${airline.Airline}</div><div class="text-xs text-gray-400">${airline['Country of Origin']}</div><div class="flex items-center justify-between mt-1"><span class="text-xs text-green-400">${numCountries} countries</span><span class="region-badge ${regionColors[region]}">${region}</span></div></button>`; }).join(''); }

        function renderRegionMarketShare() { const regions = ['Asia-Pacific', 'Europe', 'Middle East', 'Americas']; const elementIds = { 'Asia-Pacific': 'regionAsiaPacific', 'Europe': 'regionEurope', 'Middle East': 'regionMiddleEast', 'Americas': 'regionAmericas' }; regions.forEach(region => { const regionAirlines = airlineData.filter(airline => { const airlineRegion = regionMapping[airline.Airline]?.region; return airlineRegion === region; }).sort((a, b) => parseInt(b['Number of Countries']) - parseInt(a['Number of Countries'])).slice(0, 10); const totalCountries = regionAirlines.reduce((sum, a) => sum + parseInt(a['Number of Countries']), 0); const content = document.getElementById(elementIds[region]); const countryToCode = { 'China': 'cn', 'South Korea': 'kr', 'India': 'in', 'Singapore': 'sg', 'Japan': 'jp', 'Thailand': 'th', 'Malaysia': 'my', 'Indonesia': 'id', 'Philippines': 'ph', 'Vietnam': 'vn', 'Taiwan': 'tw', 'Hong Kong': 'hk', 'Australia': 'au', 'New Zealand': 'nz', 'United Kingdom': 'gb', 'Germany': 'de', 'France': 'fr', 'Spain': 'es', 'Italy': 'it', 'Netherlands': 'nl', 'Switzerland': 'ch', 'Belgium': 'be', 'Austria': 'at', 'Portugal': 'pt', 'Greece': 'gr', 'Poland': 'pl', 'Turkey': 'tr', 'Ireland': 'ie', 'Norway': 'no', 'Sweden': 'se', 'Denmark': 'dk', 'Finland': 'fi', 'United Arab Emirates': 'ae', 'Saudi Arabia': 'sa', 'Qatar': 'qa', 'Kuwait': 'kw', 'Oman': 'om', 'Bahrain': 'bh', 'Israel': 'il', 'Jordan': 'jo', 'Lebanon': 'lb', 'Egypt': 'eg', 'United States': 'us', 'Canada': 'ca', 'Mexico': 'mx', 'Brazil': 'br', 'Argentina': 'ar', 'Chile': 'cl', 'Colombia': 'co', 'Peru': 'pe', 'Panama': 'pa', 'Costa Rica': 'cr' }; content.innerHTML = regionAirlines.map((airline, idx) => { const countries = parseInt(airline['Number of Countries']); const share = ((countries / totalCountries) * 100).toFixed(1); const code = countryToCode[airline['Country of Origin']] || 'un'; const rankClass = idx < 3 ? `rank-${idx + 1}` : ''; return `<button onclick="showAirlineModal('${airline.Airline.replace(/'/g, "\\'")}', '${airline['Country of Origin'].replace(/'/g, "\\'")}') " class="tab-button ${rankClass} w-full px-2 py-2 rounded-lg text-xs font-semibold bg-slate-700/40 hover:bg-slate-700/60 border border-slate-600/30 transition-all text-left"><div class="flex items-center gap-1.5"><span class="text-orange-400 font-bold w-6">#${idx + 1}</span><img src="https://flagcdn.com/w80/${code}.png" alt="${code}" class="w-5 h-4 rounded"><div class="flex-1 min-w-0"><div class="font-bold text-white text-xs truncate">${airline.Airline}</div><div class="text-xs text-gray-400 truncate">${airline['Country of Origin']}</div></div><div class="text-right"><div class="text-blue-400 font-bold text-xs">${countries}</div><div class="text-xs text-gray-400">${share}%</div></div></div></button>`; }).join(''); }); }

        function showRegion(region) { }

        function renderConnectivityScore() { const connectivityData = Object.entries(countryAirlines).map(([country, airlines]) => ({ country: country, score: airlines.length, normalizedScore: 0 })).sort((a, b) => b.score - a.score); const maxScore = connectivityData[0]?.score || 1; connectivityData.forEach(item => { item.normalizedScore = ((item.score / maxScore) * 10).toFixed(1); }); const top50 = connectivityData.slice(0, 50); const content = document.getElementById('connectivityContent'); const countryToCode = { 'United States': 'USA', 'United Kingdom': 'GBR', 'China': 'CHN', 'France': 'FRA', 'Germany': 'DEU', 'Spain': 'ESP', 'Italy': 'ITA', 'Canada': 'CAN', 'Australia': 'AUS', 'Japan': 'JPN', 'South Korea': 'KOR', 'India': 'IND', 'Brazil': 'BRA', 'Mexico': 'MEX', 'Netherlands': 'NLD', 'Switzerland': 'CHE', 'Belgium': 'BEL', 'Austria': 'AUT', 'Sweden': 'SWE', 'Norway': 'NOR', 'Denmark': 'DNK', 'Finland': 'FIN', 'Poland': 'POL', 'Portugal': 'PRT', 'Greece': 'GRC', 'Turkey': 'TUR', 'Russia': 'RUS', 'Thailand': 'THA', 'Singapore': 'SGP', 'Malaysia': 'MYS', 'Indonesia': 'IDN', 'Philippines': 'PHL', 'Vietnam': 'VNM', 'United Arab Emirates': 'ARE', 'Saudi Arabia': 'SAU', 'Qatar': 'QAT', 'Kuwait': 'KWT', 'Oman': 'OMN', 'Bahrain': 'BHR', 'Israel': 'ISR', 'Egypt': 'EGY', 'South Africa': 'ZAF', 'New Zealand': 'NZL', 'Argentina': 'ARG', 'Chile': 'CHL', 'Colombia': 'COL', 'Peru': 'PER', 'Ireland': 'IRL', 'Czech Republic': 'CZE', 'Hungary': 'HUN', 'Romania': 'ROU', 'Taiwan': 'TWN', 'Hong Kong': 'HKG', 'Pakistan': 'PAK', 'Bangladesh': 'BGD', 'Sri Lanka': 'LKA', 'Nepal': 'NPL', 'Myanmar': 'MMR', 'Cambodia': 'KHM', 'Laos': 'LAO', 'Mongolia': 'MNG', 'Brunei': 'BRN', 'Maldives': 'MDV', 'Jordan': 'JOR', 'Lebanon': 'LBN', 'Iraq': 'IRQ', 'Iran': 'IRN', 'Syria': 'SYR', 'Yemen': 'YEM', 'Algeria': 'DZA', 'Morocco': 'MAR', 'Tunisia': 'TUN', 'Libya': 'LBY', 'Kenya': 'KEN', 'Ethiopia': 'ETH', 'Nigeria': 'NGA', 'Ghana': 'GHA', 'Senegal': 'SEN', 'Tanzania': 'TZA', 'Uganda': 'UGA', 'Rwanda': 'RWA', 'Zambia': 'ZMB', 'Zimbabwe': 'ZWE', 'Mauritius': 'MUS', 'Seychelles': 'SYC', 'Venezuela': 'VEN', 'Ecuador': 'ECU', 'Bolivia': 'BOL', 'Uruguay': 'URY', 'Paraguay': 'PRY', 'Costa Rica': 'CRI', 'Panama': 'PAN', 'Guatemala': 'GTM', 'Honduras': 'HND', 'El Salvador': 'SLV', 'Nicaragua': 'NIC', 'Jamaica': 'JAM', 'Dominican Republic': 'DOM', 'Cuba': 'CUB', 'Haiti': 'HTI', 'Trinidad and Tobago': 'TTO', 'Bahamas': 'BHS', 'Barbados': 'BRB', 'Belize': 'BLZ', 'Guyana': 'GUY', 'Suriname': 'SUR' }; const flagCode = { 'United States': 'us', 'United Kingdom': 'gb', 'China': 'cn', 'France': 'fr', 'Germany': 'de', 'Spain': 'es', 'Italy': 'it', 'Canada': 'ca', 'Australia': 'au', 'Japan': 'jp', 'South Korea': 'kr', 'India': 'in', 'Brazil': 'br', 'Mexico': 'mx', 'Netherlands': 'nl', 'Switzerland': 'ch', 'Belgium': 'be', 'Austria': 'at', 'Sweden': 'se', 'Norway': 'no', 'Denmark': 'dk', 'Finland': 'fi', 'Poland': 'pl', 'Portugal': 'pt', 'Greece': 'gr', 'Turkey': 'tr', 'Russia': 'ru', 'Thailand': 'th', 'Singapore': 'sg', 'Malaysia': 'my', 'Indonesia': 'id', 'Philippines': 'ph', 'Vietnam': 'vn', 'United Arab Emirates': 'ae', 'Saudi Arabia': 'sa', 'Qatar': 'qa', 'Kuwait': 'kw', 'Oman': 'om', 'Bahrain': 'bh', 'Israel': 'il', 'Egypt': 'eg', 'South Africa': 'za', 'New Zealand': 'nz', 'Argentina': 'ar', 'Chile': 'cl', 'Colombia': 'co', 'Peru': 'pe', 'Ireland': 'ie', 'Czech Republic': 'cz', 'Hungary': 'hu', 'Romania': 'ro', 'Taiwan': 'tw', 'Hong Kong': 'hk', 'Pakistan': 'pk', 'Bangladesh': 'bd', 'Sri Lanka': 'lk' }; content.innerHTML = `<div class="flex flex-wrap gap-2">${top50.map((item, idx) => { const code = countryToCode[item.country] || 'N/A'; const flag = flagCode[item.country] || 'un'; const rankClass = idx < 3 ? `rank-${idx + 1}` : ''; return `<button onclick="showCountryModal('${item.country.replace(/'/g, "\\'")}') " class="tab-button ${rankClass} px-3 py-2 rounded-lg text-xs font-semibold bg-slate-700/40 hover:bg-slate-700/60 border border-slate-600/30 transition-all"><img src="https://flagcdn.com/w80/${flag}.png" alt="${flag}" class="w-5 h-4 inline-block mr-2 rounded"><span class="font-mono font-bold text-white">${code}</span><span class="ml-2 text-cyan-400 font-bold">${item.normalizedScore}</span><span class="ml-2 text-xs text-gray-400">${item.score}</span><span class="ml-1 text-xs opacity-75">#${idx + 1}</span></button>`; }).join('')}</div>`; }

        function setupSearch() { document.getElementById('searchInput').addEventListener('input', (e) => { renderCountriesGrid(e.target.value); }); }

        function setupAirlineSearch() { document.getElementById('searchAirlineInput').addEventListener('input', (e) => { renderAirlinesGrid(e.target.value); }); }

        function showCountryModal(country) { const airlines = countryAirlines[country]; document.getElementById('modalTitle').textContent = country; document.getElementById('modalSubtitle').textContent = `${airlines.length} airline${airlines.length !== 1 ? 's' : ''} serving this country`; airlines.sort((a, b) => b.totalCountries - a.totalCountries); const content = `<div class="grid gap-3">${airlines.map(a => { const regionColors = { 'Asia-Pacific': 'bg-blue-500/20 text-blue-300', 'Europe': 'bg-purple-500/20 text-purple-300', 'Middle East': 'bg-orange-500/20 text-orange-300', 'Americas': 'bg-green-500/20 text-green-300', 'Other': 'bg-gray-500/20 text-gray-300' }; return `<div onclick="showAirlineModal('${a.airline.replace(/'/g, "\\'")}', '${a.origin.replace(/'/g, "\\'")}')" class="modal-item p-4 bg-gradient-to-br from-slate-700/40 to-slate-800/40 border border-slate-600/30 rounded-xl"><div class="flex justify-between items-start"><div class="flex-1"><div class="flex items-center gap-2 mb-1"><h4 class="font-bold text-lg text-white">${a.airline}</h4><span class="region-badge ${regionColors[a.region]}">${a.region}</span></div><p class="text-sm text-gray-400">Based in ${a.origin}</p></div><div class="text-right"><div class="text-2xl font-black orbitron text-blue-400">${a.totalCountries}</div><div class="text-xs text-gray-400">countries</div></div></div></div>`; }).join('')}</div>`; document.getElementById('modalContent').innerHTML = content; document.getElementById('infoModal').classList.remove('hidden'); }

        function showAirlineModal(airlineName, originCountry) { const airline = airlineData.find(a => a.Airline === airlineName); if (!airline) return; const region = regionMapping[airlineName]?.region || 'Other'; document.getElementById('modalTitle').textContent = airlineName; document.getElementById('modalSubtitle').textContent = `${region} • Based in ${originCountry} • Serving ${airline['Number of Countries']} countries`; const countries = airline['Countries Served'].split(',').map(c => c.trim()).sort(); const content = `<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2">${countries.map(country => `<div onclick="showCountryModal('${country.replace(/'/g, "\\'")}')" class="modal-item px-3 py-2 bg-slate-700/50 border border-slate-600/30 rounded text-sm text-center hover:bg-slate-700/80">${country}</div>`).join('')}</div>`; document.getElementById('modalContent').innerHTML = content; document.getElementById('infoModal').classList.remove('hidden'); }

        function closeModal() { document.getElementById('infoModal').classList.add('hidden'); }

        loadData();
    </script>
</body>
</html>
